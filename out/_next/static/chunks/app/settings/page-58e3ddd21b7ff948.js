(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[662],{9797:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>r});var a=s(95155),n=s(15239);function r(){return(0,a.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",display:"flex",justifyContent:"center",alignItems:"center",background:"#09090B",zIndex:9999},children:(0,a.jsx)("div",{style:{width:"150px",height:"82.8px"},children:(0,a.jsx)(n.default,{src:"/assets/loading.gif",alt:"Loading...",width:500,height:276,style:{width:"100%",height:"100%",objectFit:"contain"},unoptimized:!0})})})}},52802:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var a=s(95155),n=s(12115),r=s(20063),i=s(9797),o=s(80549),c=s(76077),l=s.n(c);function u(){let e=(0,r.useRouter)(),t=(0,r.useSearchParams)().get("error"),[s,c]=(0,n.useState)(null);(0,n.useEffect)(()=>{t||(window.dispatchEvent(new CustomEvent("openSettings",{detail:{tab:"Account"}})),e.replace("/"))},[e,t]);let u=(0,o.n)({mutationFn:async e=>{c(null);let t=await fetch("/api/accounts/force-revoke-check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({providerAccountId:e})}),s=await t.json();if(!t.ok)throw Error(s.error||"Failed to check status.");return s},onSuccess:e=>{c({message:e.message||"Success! Automatically retrying...",isError:!1}),setTimeout(async()=>{try{let e=await fetch("/api/auth/google-link-url?next=/settings");if(!e.ok)throw Error("Failed to get authorization URL for retry.");let{authUrl:t}=await e.json();window.location.href=t}catch(e){c({message:(null==e?void 0:e.message)||"Could not automatically retry. Please add the account again manually.",isError:!0})}},1500)},onError:e=>{c({message:e.message,isError:!0})}});if(!t)return(0,a.jsx)(i.default,{});let d={message:t,providerAccountId:null};try{let e=JSON.parse(t);d.message=e.error_message||t,d.providerAccountId=e.providerAccountId||null}catch(e){}return(0,a.jsx)("div",{className:l().container,children:(0,a.jsxs)("div",{className:l().card,children:[(0,a.jsxs)("div",{className:l().errorHeader,children:[(0,a.jsx)("span",{className:l().iconLarge,children:"⚠"}),(0,a.jsx)("h1",{className:l().errorTitle,children:"Account Already Linked"})]}),(0,a.jsxs)("div",{className:l().contentSpace,children:[(0,a.jsx)("p",{className:l().errorMessage,children:d.message}),(0,a.jsxs)("div",{className:l().infoSection,children:[(0,a.jsx)("p",{className:l().infoSubtitle,children:"To resolve this, the owner of the Google account must:"}),(0,a.jsxs)("ol",{className:l().instructionsList,children:[(0,a.jsxs)("li",{children:["Go to their Google Account settings (",(0,a.jsx)("a",{href:"https://myaccount.google.com/permissions",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"Manage Permissions"}),")."]}),(0,a.jsx)("li",{children:"Find this application in the list of third-party apps."}),(0,a.jsx)("li",{children:"Remove all permissions for this application."})]})]}),(0,a.jsxs)("div",{className:l().infoSection,children:[(0,a.jsx)("p",{className:l().infoSubtitle,children:"After revoking permissions, click here:"}),(0,a.jsx)("button",{onClick:()=>{d.providerAccountId?u.mutate(d.providerAccountId):c({message:"Could not determine account ID to check. Please try the flow again.",isError:!0})},disabled:u.isPending,className:l().checkButton,children:u.isPending?"Checking...":"I have revoked access in Google, check again"}),s&&(0,a.jsxs)("div",{className:"".concat(l().statusContainer," ").concat(s.isError?l().statusContainerError:l().statusContainerSuccess),children:[s.isError?(0,a.jsx)("span",{className:l().iconSmall,children:"⚠"}):(0,a.jsx)("span",{className:l().iconSmall,children:"✓"}),(0,a.jsx)("span",{children:s.message})]})]})]}),(0,a.jsx)("button",{onClick:()=>e.replace("/"),className:l().returnButton,children:"Return to Dashboard"})]})})}},58208:(e,t,s)=>{Promise.resolve().then(s.bind(s,52802))},76077:e=>{e.exports={container:"page_container__3kyYS",content:"page_content__jRfF0",header:"page_header__vDuPv",icon:"page_icon__xUoi_",title:"page_title__y7ley",message:"page_message__RA6qC",accountInfo:"page_accountInfo__YfniL",accountTitle:"page_accountTitle__AJbZ_",accountId:"page_accountId__kKUYT",actions:"page_actions__f_HTv",statusMessage:"page_statusMessage__GqjiL",card:"page_card__j8Hx0",errorHeader:"page_errorHeader__R27gh",errorTitle:"page_errorTitle__v9ORu",contentSpace:"page_contentSpace__ktTPb",errorMessage:"page_errorMessage__Z8ebY",infoSection:"page_infoSection__G_avn",infoSubtitle:"page_infoSubtitle__rbSyO",instructionsList:"page_instructionsList__Pgb8l",checkButton:"page_checkButton__yiWbq",statusContainer:"page_statusContainer___iSDD",statusContainerError:"page_statusContainerError__PQMnG",statusContainerSuccess:"page_statusContainerSuccess__mLylz",returnButton:"page_returnButton__FlXOt",iconLarge:"page_iconLarge__zucZa",iconSmall:"page_iconSmall__R1KA7"}}},e=>{e.O(0,[654,96,358],()=>e(e.s=58208)),_N_E=e.O()}]);