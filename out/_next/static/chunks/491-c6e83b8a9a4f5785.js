(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[491],{1989:e=>{e.exports={container:"display-settings_container__02jni",section:"display-settings_section__ZageT",heading:"display-settings_heading__dC1Ni",description:"display-settings_description__qbTUm",layoutContainer:"display-settings_layoutContainer___nkBl",layoutInfo:"display-settings_layoutInfo__DMoNJ",layoutTitle:"display-settings_layoutTitle__fJmuM",layoutSubtitle:"display-settings_layoutSubtitle__y1U1T",detailsContainer:"display-settings_detailsContainer__cY7eV",detailItem:"display-settings_detailItem__9yRbf",detailLabel:"display-settings_detailLabel__S3gtr",comingSoon:"display-settings_comingSoon__no5Yw"}},10872:e=>{e.exports={loadingContainer:"dashboard-client_loadingContainer__xPM8d",loadingImageContainer:"dashboard-client_loadingImageContainer__7n_tk"}},11939:e=>{e.exports={skeletonCard:"resizable-bento-grid_skeletonCard__uPO9m",loadingImageContainer:"resizable-bento-grid_loadingImageContainer__128xo",loadingImage:"resizable-bento-grid_loadingImage__sin0f",panelMotion:"resizable-bento-grid_panelMotion__tV__m",resizeHandleHorizontal:"resizable-bento-grid_resizeHandleHorizontal__vSkGd",resizeHandleVertical:"resizable-bento-grid_resizeHandleVertical__yxwyP",singleRowPanelGroup:"resizable-bento-grid_singleRowPanelGroup__bc_Yp",resizeHandleInline:"resizable-bento-grid_resizeHandleInline__fznUQ"}},17549:e=>{e.exports={dockButton:"layout-toggle_dockButton__e_9_d",icon:"layout-toggle_icon__6Ik24",settingsButton:"layout-toggle_settingsButton__wbD6w"}},21381:(e,t,n)=>{"use strict";n.d(t,{createExtensionClient:()=>l});var a=n(11993),s=n(95704);let i=e=>window.__EXTENSION_ENV__?window.__EXTENSION_ENV__[e]||"":s.env[e]||"",r=i("NEXT_PUBLIC_SUPABASE_URL"),o=i("NEXT_PUBLIC_SUPABASE_ANON_KEY");function l(){if(console.log("Creating new Supabase extension client..."),!r||!o)return console.warn("Supabase credentials not available in extension, using offline mode"),null;try{let e=(0,a.UU)(r,o,{auth:{persistSession:!0,storage:window.localStorage,autoRefreshToken:!1,detectSessionInUrl:!1},realtime:{disabled:!0,params:{eventsPerSecond:0}},global:{headers:{},fetch:void 0},db:{schema:"public"}});if(e.realtime)try{e.realtime.disconnect(),e.realtime.connect=()=>Promise.resolve(),e.realtime.disconnect=()=>Promise.resolve()}catch(e){console.log("Realtime already disabled:",e)}return console.log("Supabase extension client created successfully (offline mode)"),e}catch(e){return console.error("Error creating Supabase client, falling back to null:",e),null}}},41401:e=>{e.exports={eventCard:"schedule-widget_eventCard__nEbFv",eventCardCurrent:"schedule-widget_eventCardCurrent__n4y9Y",eventCardDefault:"schedule-widget_eventCardDefault__hbd1H",eventTitle:"schedule-widget_eventTitle___TMTn",eventTime:"schedule-widget_eventTime__Kavfo",daySection:"schedule-widget_daySection__kCDMb",currentTimeIndicator:"schedule-widget_currentTimeIndicator__DXCYQ",currentTimeLine:"schedule-widget_currentTimeLine__HVAKF",currentTimeDot:"schedule-widget_currentTimeDot__U39rx",dayHeader:"schedule-widget_dayHeader__2ebew",container:"schedule-widget_container__Cp0gV",sidebar:"schedule-widget_sidebar__OL1Qo",sidebarHeader:"schedule-widget_sidebarHeader__GlMxT",sidebarContent:"schedule-widget_sidebarContent__MJVhA",sidebarFooter:"schedule-widget_sidebarFooter__2HF_N",dayDateContainer:"schedule-widget_dayDateContainer__JuwfC",dayText:"schedule-widget_dayText__6864x",todayDot:"schedule-widget_todayDot__L9JqB",monthText:"schedule-widget_monthText__o38Ak",rightContent:"schedule-widget_rightContent__zIUS0",scrollContainer:"schedule-widget_scrollContainer__crjfd",errorContainer:"schedule-widget_errorContainer__IFByH",errorTitle:"schedule-widget_errorTitle__zWKwt",errorMessage:"schedule-widget_errorMessage__F2WLO",emptyStateContainer:"schedule-widget_emptyStateContainer__Z_GdP",relativeContainer:"schedule-widget_relativeContainer__0m4t_",calendarIcon:"schedule-widget_calendarIcon__SZq7k"}},41742:e=>{e.exports={drawerTrigger:"settings-drawer_drawerTrigger__QruVr",settingsIcon:"settings-drawer_settingsIcon__oWMM9",group:"settings-drawer_group__twt0K",drawerContent:"settings-drawer_drawerContent__7X1RK",container:"settings-drawer_container__a8XYp",grabHandle:"settings-drawer_grabHandle__ezjqG",grabBar:"settings-drawer_grabBar__XYVDe",header:"settings-drawer_header__XmKlB",title:"settings-drawer_title___rHM9",closeButton:"settings-drawer_closeButton__jSbnE",closeIcon:"settings-drawer_closeIcon__N7CwB",scrollableContent:"settings-drawer_scrollableContent__JVJuv",sidebar:"settings-drawer_sidebar__a4g3j",nav:"settings-drawer_nav__2y5y6",navList:"settings-drawer_navList__v838t",navButton:"settings-drawer_navButton__gxOc_",navButtonActive:"settings-drawer_navButtonActive__M2z_7",navButtonInactive:"settings-drawer_navButtonInactive__nkE1O",navButtonContent:"settings-drawer_navButtonContent__vLxDO",navButtonTitle:"settings-drawer_navButtonTitle__ROKWk",navButtonDescription:"settings-drawer_navButtonDescription__Mcacv",mainContent:"settings-drawer_mainContent__vN_ye",contentPanel:"settings-drawer_contentPanel__bwKm0"}},42592:e=>{e.exports={flipContainer:"recorder-widget_flipContainer__B_iqS",flipper:"recorder-widget_flipper__pVD_V",flipped:"recorder-widget_flipped__tSIHj",front:"recorder-widget_front__7M76B",back:"recorder-widget_back__mnfET",container:"recorder-widget_container__VzAVc",content:"recorder-widget_content__pR4tP",header:"recorder-widget_header__JPrOh",headerText:"recorder-widget_headerText__OB5gA",body:"recorder-widget_body__7tji2",buttonContainer:"recorder-widget_buttonContainer__6p_ky",button:"recorder-widget_button__xk7ww",buttonOuter:"recorder-widget_buttonOuter__JD9mb",buttonBackground:"recorder-widget_buttonBackground__QcTmI",buttonBorder:"recorder-widget_buttonBorder__UfNgc",buttonTopHighlight:"recorder-widget_buttonTopHighlight__DLFWX",recordingDot:"recorder-widget_recordingDot__K9nyw",recordingDotHover:"recorder-widget_recordingDotHover__nli8s",microphoneIcon:"recorder-widget_microphoneIcon__uhGwt",micIcon:"recorder-widget_micIcon__gdkxV",bodyText:"recorder-widget_bodyText__NfnZP",recordingBody:"recorder-widget_recordingBody__MGV5J",waveformContainer:"recorder-widget_waveformContainer__Jfmtb",waveformBar:"recorder-widget_waveformBar__RhbXo",waveformBarActive:"recorder-widget_waveformBarActive__ycH_K",waveformPulse:"recorder-widget_waveformPulse__SDhw_",timerContainer:"recorder-widget_timerContainer__GMtad",timer:"recorder-widget_timer__cO_ca",recordingControls:"recorder-widget_recordingControls__Q1nVl",controlButton:"recorder-widget_controlButton__Nlq4l",controlButtonInner:"recorder-widget_controlButtonInner__XvA2N",controlIcon:"recorder-widget_controlIcon__jfZ2W",doneButton:"recorder-widget_doneButton__ITo9p",doneText:"recorder-widget_doneText__7QlSn",permissionMessage:"recorder-widget_permissionMessage__jRHZ6",processingContainer:"recorder-widget_processingContainer__Ibd7x",transcribingWrapper:"recorder-widget_transcribingWrapper__QFaFE",transcribingContent:"recorder-widget_transcribingContent__x0sQw",gifPlaceholder:"recorder-widget_gifPlaceholder__R3gr8",animatedDotsContainer:"recorder-widget_animatedDotsContainer__8NPYR",animatedDot:"recorder-widget_animatedDot__MICDK",dotPulse:"recorder-widget_dotPulse___YNzH",transcribingTitle:"recorder-widget_transcribingTitle__OPHo9",transcribingSubtitle:"recorder-widget_transcribingSubtitle__A8FDT",okButton:"recorder-widget_okButton__ZZSeM",successContainer:"recorder-widget_successContainer__YP67M",muteButtonActive:"recorder-widget_muteButtonActive__Z2ukK",muteButtonInnerActive:"recorder-widget_muteButtonInnerActive__pTMrI",muteTextActive:"recorder-widget_muteTextActive__e1IQ6","backface-visibility-hidden":"recorder-widget_backface-visibility-hidden__DSza_"}},46122:(e,t,n)=>{"use strict";n.d(t,{NotesWidget:()=>A});var a=n(95155),s=n(12115),i=n(54313),r=n(25891),o=n(58293),l=n(18916),c=n(65920),d=n(2327);async function u(){try{let e=await d.F.get("/api/notes");if(!e.ok){let t=await e.text();throw console.error("Network response was not ok: ".concat(e.status," ").concat(e.statusText),t),Error("Network response was not ok: ".concat(e.status," ").concat(e.statusText))}let t=await e.json();if(t.success)return t.data||[];throw console.error("Failed to fetch notes:",t.error),Error(t.error||"Failed to fetch notes")}catch(e){return console.error("Error in getNotes:",e),[]}}async function g(e){let t=await d.F.post("/api/notes",e);if(!t.ok)throw Error("Network response was not ok");let n=await t.json();if(n.success&&n.data)return n.data;throw Error(n.error||"Failed to create note")}async function m(e){let{id:t,...n}=e,a=await d.F.put("/api/notes/".concat(t),n);if(!a.ok){let e=await a.text();throw console.error("Failed to update note: ".concat(a.status," ").concat(a.statusText),e),Error("Failed to update note: ".concat(e))}let s=await a.json();if(s.success&&s.data)return s.data;throw Error(s.error||"Failed to update note")}async function h(e){let t=await d.F.delete("/api/notes/".concat(e));if(!t.ok){let e=await t.text();throw console.error("Failed to delete note: ".concat(t.status," ").concat(t.statusText),e),Error("Failed to delete note: ".concat(e))}let n=await t.json();if(!n.success)throw Error(n.error||"Failed to delete note");return{id:e}}var _=n(26497),p=n(60776),v=n(13886),w=n(65955),x=n.n(w),f=n(10179),y=n(58415),j=n(25016);let N=s.memo(function(e){let{note:t,isSelected:n,onClick:i,onDelete:r,collapsed:o=!1,isRecentlyUpdated:l=!1,isEditing:c=!1}=e,d=(0,s.useMemo)(()=>{var e=t.content;if(!e||0===e.length)return"Empty note";try{let t=e.map(e=>e.content&&Array.isArray(e.content)?e.content.map(e=>"object"==typeof e&&"text"===e.type&&e.text?e.text:"").join(""):"").join(" ");return""===t.trim()?"Empty note":t.substring(0,100)+(t.length>100?"...":"")}catch(e){return console.error("Error generating preview:",e),"Error generating preview"}},[t.content]),u=(0,s.useMemo)(()=>{var e=t.title||"Untitled Note";let n=e.split(" ");return n.length>1?(n[0][0]+n[1][0]).toUpperCase():e.length>0?e[0].toUpperCase():"N"},[t.title]);(0,s.useMemo)(()=>!t.title||"Untitled note"===t.title||"Untitled Note"===t.title,[t.title]);let g=(0,s.useMemo)(()=>t.title&&""!==t.title.trim()?t.title:d&&"Empty note"!==d?d:"Untitled note",[t.title,d]),m=(0,s.useMemo)(()=>"Untitled note"===g,[g]),h=(0,s.useCallback)(e=>{e.stopPropagation(),i()},[i]);return((0,s.useCallback)(e=>{e.stopPropagation(),r()},[r]),o)?(0,a.jsx)(f.Y,{children:(0,a.jsx)(y.P.div,{layout:!0,initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1,y:l?[0,-20,0]:0},exit:{scale:.8,opacity:0},transition:{type:"spring",stiffness:500,damping:30,duration:l?.5:.3},className:(0,j.cn)("h-10 w-10 mx-auto flex items-center justify-center rounded-full cursor-pointer transition-colors relative",n?"bg-[#292929] border border-[#434343]":"bg-[#222222] border-[#222222] hover:bg-[#3D3D3D] hover:border-[#252323]",l&&"animate-promote"),onClick:h,title:g,children:(0,a.jsx)("span",{className:"font-bold text-xs text-[#c4c4c4]",children:u})})}):(0,a.jsx)(f.Y,{children:(0,a.jsxs)(y.P.div,{layout:!0,initial:{y:20,opacity:0},animate:{y:0,opacity:1},exit:{y:-20,opacity:0},transition:{type:"spring",stiffness:500,damping:30},className:(0,j.cn)("widget-list-item widget-list-item--notes flex flex-col items-start w-full text-left rounded-lg p-3 mb-1 relative group transition-colors cursor-pointer border",n&&"widget-list-item--active",l&&"animate-highlight"),onClick:h,children:[(0,a.jsx)("div",{className:"flex justify-between w-full items-start notelist",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 flex-1 min-w-0",children:[(0,a.jsx)("div",{className:(0,j.cn)("font-inter-display overflow-hidden truncate flex-1",m?"font-medium text-[14px] text-[#5c5c5c] italic":t.title&&""!==t.title.trim()?"font-medium text-[14px] text-[#c4c4c4]":"font-normal text-[12px] text-[#c4c4c4]"),children:g}),c&&(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)("div",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full animate-pulse"})})]})}),t.title&&""!==t.title.trim()&&(0,a.jsx)("div",{className:"font-inter-display font-normal text-[12px] leading-[15px] text-[#8D8D8D] w-full overflow-hidden note-preview",children:d})]})})});var b=n(97450),S=n(97003),C=n(53905),T=n.n(C);let k=s.memo(function(e){let{onDelete:t,isNewNote:n}=e,[i,r]=s.useState(!1);return(0,a.jsxs)(b.AM,{open:i,onOpenChange:r,children:[(0,a.jsx)(b.Wv,{asChild:!0,children:(0,a.jsxs)(S.$,{variant:"ghost-icon",size:"icon",children:[(0,a.jsx)("span",{className:T().srOnly,children:"Open menu"}),(0,a.jsx)("span",{className:T().icon,children:"â€¢"})]})}),(0,a.jsx)(b.hl,{align:"end",className:T().popoverContent,children:(0,a.jsx)(S.$,{variant:"ghost",onClick:e=>{e.stopPropagation(),r(!1),t()},disabled:n,className:T().deleteButton,children:"Delete"})})]})});var E=n(46276),D=n(18720);function I(e){let{children:t,defaultWidth:n=300,minWidth:i=120,maxWidth:r=500,collapsed:o=!1,onToggleCollapse:l}=e,[c,d]=(0,s.useState)(n),u=(0,s.useRef)(!1),g=(0,s.useRef)(null),m=(0,s.useRef)(!1);(0,s.useEffect)(()=>{o||d(n)},[o,n]);let h=()=>{u.current=!1,document.removeEventListener("mousemove",_),document.removeEventListener("mouseup",h)},_=e=>{if(!u.current||!g.current)return;let t=e.clientX-g.current.getBoundingClientRect().left;!m.current&&(!o&&t<90?(l(),m.current=!0):o&&t>90&&(l(),m.current=!0)),o||d(t=Math.max(i,Math.min(t,r)))};return(0,a.jsxs)("div",{className:x().resizablePanels,ref:g,children:[(0,a.jsx)("div",{style:{width:o?60:c},className:x().resizableLeft,children:t[0]}),(0,a.jsx)("div",{className:x().resizableHandle,onMouseDown:e=>{e.preventDefault(),u.current=!0,m.current=!1,document.addEventListener("mousemove",_),document.addEventListener("mouseup",h)}}),(0,a.jsx)("div",{className:x().resizableRight,children:t[1]})]})}function A(){var e,t;let{notes:n,createNote:d,updateNote:w,deleteNote:f,isLoadingNotes:y,loadNotes:b,updateNoteOptimistic:S}=function(){let[e,t]=(0,s.useState)([]),[n,a]=(0,s.useState)(!1),[i,r]=(0,s.useState)(null);return{notes:e,isLoadingNotes:n,notesError:i,loadNotes:(0,s.useCallback)(async()=>{a(!0),r(null);try{let e=await u();t(e)}catch(e){console.error("Error loading notes:",e),r(e)}finally{a(!1)}},[]),createNote:{mutate:async e=>{try{let n=await g(e);return t(e=>[n,...e]),n}catch(e){throw e}}},updateNote:{mutate:async e=>{try{let n=await m(e);return t(t=>t.map(t=>t.id===e.id?n:t)),n}catch(e){throw e}}},deleteNote:{mutate:async e=>{try{return await h(e),t(t=>t.filter(t=>t.id!==e)),{id:e}}catch(e){throw e}}},updateNoteOptimistic:(0,s.useCallback)((e,n)=>{t(t=>t.map(t=>t.id===e?{...t,...n}:t))},[])}}(),{toast:C}=(0,E.dj)(),[T,A]=(0,s.useState)(null),[B,P]=(0,s.useState)(""),[M,z]=(0,s.useState)(!1),[L,R]=(0,s.useState)(!1),[O,F]=(0,s.useState)(!1),[H,W]=(0,s.useState)("idle"),[U,G]=(0,s.useState)(!1),V=(0,s.useRef)(null),J=(0,s.useRef)(null),Y=(0,s.useRef)(!1),Z=(0,s.useRef)(""),X=(0,s.useRef)(""),q=(0,s.useRef)(null),K=(0,s.useRef)(!1),Q=(0,s.useRef)(0);(0,s.useRef)(!1);let $=(0,s.useCallback)(()=>(Q.current+=1,"draft-".concat(Date.now(),"-").concat(Q.current)),[]);(0,s.useEffect)(()=>{b()},[]),(0,s.useEffect)(()=>{if(!y){if(!K.current){K.current=!0;let e={id:$(),title:"",content:c.MG};A(e),P(""),q.current=e.id,Z.current=JSON.stringify(c.MG),X.current="";return}if(q.current&&!q.current.startsWith("draft-")&&!n.some(e=>e.id===q.current)){let e={id:$(),title:"",content:c.MG};A(e),P(""),q.current=e.id,Z.current=JSON.stringify(c.MG),X.current=""}}},[n,y,$]),(0,s.useEffect)(()=>{if(!V.current||!(null==T?void 0:T.content))return;let e=Array.isArray(T.content)?T.content:[],t=JSON.stringify(e);if(t===Z.current)return;Y.current=!0;try{V.current.replaceBlocks(V.current.document,e),Z.current=t,X.current=T.title||"",void 0!==T.title&&T.title!==B&&ea(T.title)}catch(e){console.error("Failed to update editor content:",e)}let n=setTimeout(()=>{Y.current=!1},200);return()=>clearTimeout(n)},[null==T?void 0:T.id]);let ee=(0,s.useRef)(null),et=(0,s.useRef)(!1),en=(0,s.useRef)(!1),ea=(0,s.useCallback)(e=>{en.current||P(e)},[]);(0,s.useEffect)(()=>{ee.current=T},[T]),(0,s.useCallback)(async function(e){var t,n;let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(L||!(null==e?void 0:e.id))return;let s=null==(t=e.id)?void 0:t.startsWith("draft-"),i={...e,title:(null==(n=e.title)?void 0:n.trim())||"Untitled Note"};R(!0);try{if(s){let e=await d.mutate({...i,temporaryId:i.id});q.current=e.id,Z.current=JSON.stringify(e.content),X.current=e.title||"",ee.current={id:e.id,title:e.title,content:e.content},a&&C({title:"Note created",description:"Your note has been saved successfully."})}else{let e=await w.mutate(i);Z.current=JSON.stringify(e.content),X.current=e.title||""}}catch(e){console.error("Failed to save note:",e),C({title:s?"Failed to create note":"Failed to save note",description:e.message||"Please try again.",variant:"destructive"})}finally{R(!1)}},[d,w,C,L]);let es=(0,s.useCallback)(e=>{V.current=e},[]),ei=(0,s.useCallback)(e=>{let t=e.target.value;en.current=!0,ee.current&&(requestAnimationFrame(()=>{var e;P(t),ee.current={...ee.current,title:t},F(!0),(null==(e=ee.current.id)?void 0:e.startsWith("draft-"))||S(ee.current.id,{title:t})}),clearTimeout(window.typingTimeout),window.typingTimeout=setTimeout(()=>{en.current=!1},2e3),console.log("Title changed, scheduling save in 2 seconds..."),clearTimeout(window.titleSaveTimeout),window.titleSaveTimeout=setTimeout(async()=>{let e=ee.current;if(!(null==e?void 0:e.id)||et.current)return;let t=e.id.startsWith("draft-");try{if(t){var n;et.current=!0,W("saving"),console.log("Creating new note from title:",e.title);let t=await fetch("/api/notes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:(null==(n=e.title)?void 0:n.trim())||"Untitled Note",content:e.content})});if(t.ok){let n=await t.json();n.success&&(console.log("Title saved by creating new note:",n.data.id),q.current=n.data.id,ee.current={...e,id:n.data.id},A({...e,id:n.data.id,title:B}),S(n.data.id,{title:n.data.title,content:n.data.content}),F(!1),W("saved"),b(),setTimeout(()=>{en.current=!1,W("idle")},2e3))}et.current=!1}else{console.log("Saving title:",e.title);let t=await fetch("/api/notes",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({noteId:e.id,title:e.title,content:e.content})});if(t.ok)console.log("Title saved successfully"),F(!1);else{let e=await t.json();console.error("Failed to save title:",e)}}}catch(e){console.error("Title save failed:",e),et.current=!1}},2e3))},[]),er=(0,s.useCallback)(()=>{var e;if(!ee.current)return;clearTimeout(window.titleSaveTimeout);let t=ee.current;(null==(e=t.id)?void 0:e.startsWith("draft-"))||!t.title||fetch("/api/notes",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({noteId:t.id,title:t.title,content:t.content})}).then(e=>{e.ok&&(console.log("Title saved on blur"),F(!1))}).catch(e=>{console.error("Failed to save title on blur:",e)})},[]),eo=(0,s.useCallback)(e=>{if(A(e),ea(e.title||""),q.current=e.id,Z.current=JSON.stringify(e.content),X.current=e.title||"",V.current){Y.current=!0;try{V.current.replaceBlocks(V.current.document,e.content||c.MG)}catch(e){console.error("Failed to update editor content:",e)}setTimeout(()=>{Y.current=!1},100)}},[]),el=(0,s.useCallback)(()=>{ee.current&&(clearTimeout(window.contentSaveTimeout),clearTimeout(window.titleSaveTimeout))},[]);(0,s.useEffect)(()=>{let e=e=>{let t=document.querySelector('[data-widget="notes"]');t&&!t.contains(e.target)&&el()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[el]);let ec=(0,s.useCallback)(()=>{clearTimeout(window.contentSaveTimeout),clearTimeout(window.titleSaveTimeout);let e={id:$(),title:"",content:c.MG};q.current=e.id,ee.current=e,Z.current=JSON.stringify(c.MG),X.current="",V.current&&(Y.current=!0,V.current.replaceBlocks(V.current.document,c.MG),setTimeout(()=>{Y.current=!1},200)),P(""),A(e),F(!1)},[$]),ed=(0,s.useCallback)(async e=>{if(e.startsWith("draft-")){let e={id:$(),title:"",content:c.MG};A(e),ea(""),q.current=e.id,ee.current=e,Z.current=JSON.stringify(c.MG),X.current="",V.current&&(Y.current=!0,V.current.replaceBlocks(V.current.document,c.MG),setTimeout(()=>{Y.current=!1},200));return}let t=n.find(t=>t.id===e);if(t)try{if(q.current===e){let e={id:$(),title:"",content:c.MG};A(e),ea(""),q.current=e.id,ee.current=e,Z.current=JSON.stringify(c.MG),X.current="",V.current&&(Y.current=!0,V.current.replaceBlocks(V.current.document,c.MG),setTimeout(()=>{Y.current=!1},200))}await f.mutate(e),D.o.success("Note deleted",{description:'"'.concat(t.title||"Untitled Note",'" has been deleted.'),action:{label:"Undo",onClick:async()=>{try{let e=await fetch("/api/notes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:t.title,content:t.content})});if(e.ok)await e.json(),b(),D.o.success("Note restored");else throw Error("Failed to restore note")}catch(e){D.o.error("Failed to restore note")}}},duration:1e4})}catch(t){let e=t.message||"Please try again.";e.includes("Note not found")||e.includes("404")?(D.o.info("Note was already deleted"),b()):D.o.error("Failed to delete note",{description:e})}},[f,n,$,ea,b]),eu=(0,s.useCallback)(()=>{(null==T?void 0:T.id)&&ed(T.id)},[null==T?void 0:T.id,ed]),eg=(0,s.useCallback)(()=>z(e=>!e),[]),em=(0,s.useMemo)(()=>{var e,t;return null!=(t=null==T||null==(e=T.id)?void 0:e.startsWith("draft-"))&&t},[null==T?void 0:T.id]);return(0,s.useMemo)(()=>null==T?void 0:T.id,[null==T?void 0:T.id]),(0,s.useEffect)(()=>{null==T||T.id},[null==T?void 0:T.id]),(0,a.jsx)(o.u,{"data-widget":"notes",children:(0,a.jsxs)(I,{defaultWidth:300,collapsed:M,onToggleCollapse:eg,children:[(0,a.jsxs)("div",{className:x().notesListPanel,children:[(0,a.jsx)(r.e,{title:"Notes",children:(0,a.jsx)(i.M,{onClick:ec})}),(0,a.jsx)("div",{className:(0,j.cn)(x().notesListScroll,"custom-scrollbar"),children:y?(0,a.jsx)(p.O,{}):n.length>0||T?(0,a.jsx)("div",{className:x().notesListContent,children:(0,a.jsxs)(_.N,{children:[T&&(null==(e=T.id)?void 0:e.startsWith("draft-"))&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(N,{note:{...T,title:B,content:(null==(t=ee.current)?void 0:t.content)||T.content},isSelected:!0,onClick:()=>{},onDelete:()=>ed(T.id),collapsed:M,isEditing:O},T.id)}),n.map(e=>{var t;let n=!(null==T||null==(t=T.id)?void 0:t.startsWith("draft-"))&&q.current===e.id;return(0,a.jsx)(N,{note:e,isSelected:n,onClick:()=>eo(e),onDelete:()=>ed(e.id),collapsed:M,isEditing:n&&O},e.id)})]})}):(0,a.jsx)(v.p,{title:"No Notes",description:"Create your first note."})})]}),(0,a.jsx)("div",{className:x().notesEditorPanel,children:T?(0,a.jsxs)("div",{className:x().notesContentPanel,children:[(0,a.jsx)("div",{className:x().notesEditorHeader,children:(0,a.jsxs)("div",{className:x().notesHeaderContent,children:[(0,a.jsx)("div",{className:x().notesTitleContainer,children:(0,a.jsx)("textarea",{ref:e=>{e&&(J.current=e,e.style.height="auto",e.style.height=e.scrollHeight+"px")},tabIndex:1,className:x().notesTitleInput,placeholder:"Untitled note",rows:1,value:B,onChange:e=>{ei(e);let t=e.target;t.style.height="auto",t.style.height=t.scrollHeight+"px"},onBlur:er})}),(0,a.jsx)("div",{tabIndex:3,className:x().notesActions,children:(0,a.jsx)(k,{onDelete:eu,isNewNote:em})})]})}),U&&"idle"!==H&&(0,a.jsxs)("div",{className:(0,j.cn)(x().saveStatus,x().saveStatusVisible),children:["saving"===H&&(0,a.jsxs)("div",{className:(0,j.cn)(x().saveStatusContent,x().saveStatusSaving),children:[(0,a.jsx)("div",{className:(0,j.cn)(x().saveStatusIndicator,x().saveStatusIndicatorSaving)}),"Saving..."]}),"saved"===H&&(0,a.jsxs)("div",{className:(0,j.cn)(x().saveStatusContent,x().saveStatusSaved),children:[(0,a.jsx)("div",{className:(0,j.cn)(x().saveStatusIndicator,x().saveStatusIndicatorSaved)}),"Saved"]}),"error"===H&&(0,a.jsxs)("div",{className:(0,j.cn)(x().saveStatusContent,x().saveStatusError),children:[(0,a.jsx)("div",{className:(0,j.cn)(x().saveStatusIndicator,x().saveStatusIndicatorError)}),"Error"]})]}),(0,a.jsx)("div",{className:(0,j.cn)(x().notesEditorScroll,"custom-scrollbar"),children:(0,a.jsx)(l.F,{initialContent:c.MG,onChange:e=>{var t;if(Y.current||!ee.current||(en.current=!0,JSON.stringify(e)===Z.current))return;let n=Z.current?JSON.parse(Z.current).length:0,a=Math.abs(e.length-n)>5,s={...ee.current,content:e};ee.current=s,F(!0),(null==(t=s.id)?void 0:t.startsWith("draft-"))||S(s.id,{content:e}),console.log("Content changed, scheduling save in 1 second..."),clearTimeout(window.contentSaveTimeout),window.contentSaveTimeout=setTimeout(async()=>{let e=ee.current;if(!(null==e?void 0:e.id)||et.current)return;let t=e.id.startsWith("draft-");try{if(t){var n;et.current=!0,a&&(G(!0),W("saving")),console.log("Creating new note:",e.title);let t=await fetch("/api/notes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:(null==(n=e.title)?void 0:n.trim())||"Untitled Note",content:e.content})});if(t.ok){let e=await t.json();console.log("Note created successfully:",e),q.current=e.data.id,ee.current=e.data,Z.current=JSON.stringify(e.data.content),A({...e.data,title:B}),F(!1),a&&(W("saved"),setTimeout(()=>{W("idle"),G(!1)},2e3)),b(),setTimeout(()=>{en.current=!1},2e3)}else{let e=await t.json();console.error("Failed to create note:",e),a&&(W("error"),setTimeout(()=>{W("idle"),G(!1)},3e3))}et.current=!1}else{console.log("Updating existing note:",e.id);let t=await fetch("/api/notes",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({noteId:e.id,title:e.title,content:e.content})});if(t.ok){let n=await t.json();console.log("Note updated successfully:",n),Z.current=JSON.stringify(e.content),F(!1)}else{let e=await t.json();console.error("Failed to update note:",e)}}}catch(e){console.error("Save failed:",e),et.current=!1}},1e3)},onEditorReady:es,editable:!0,className:x().notesEditorContainer},"notes-editor")})]}):(0,a.jsx)("div",{className:x().notesEmptyState,children:(0,a.jsx)("p",{className:x().notesEmptyText,children:"Select or create a note."})})})]})})}},46276:(e,t,n)=>{"use strict";n.d(t,{dj:()=>u});var a=n(12115);let s=0,i=new Map,r=e=>{if(i.has(e))return;let t=setTimeout(()=>{i.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);i.set(e,t)},o=[],l={toasts:[]};function c(e){l=((e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:n}=t;return n?r(n):e.toasts.forEach(e=>{r(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===n||void 0===n?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}})(l,e),o.forEach(e=>{e(l)})}function d(e){let t=(s=(s+1)%Number.MAX_VALUE).toString(),n=()=>c({type:"DISMISS_TOAST",toastId:t});return c({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:e=>{e||n()}}}),{id:t,dismiss:n,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function u(){let[e,t]=a.useState(l);return a.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:d,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},48687:e=>{e.exports={container:"weather-widget-new_container__TPPxR",card:"weather-widget-new_card__EbNhc",cardHeader:"weather-widget-new_cardHeader__r_hwb",date:"weather-widget-new_date__TjBDE",location:"weather-widget-new_location__YAIKZ",cardCenter:"weather-widget-new_cardCenter__Q1i_x",weatherIcon:"weather-widget-new_weatherIcon__95tG9",cardFooter:"weather-widget-new_cardFooter__yAMEA",mainTempCol:"weather-widget-new_mainTempCol__c_yXv",temperature:"weather-widget-new_temperature__eY2Sa",condition:"weather-widget-new_condition__Hwvjx",tempGroup:"weather-widget-new_tempGroup__Vuwt_",tempCol:"weather-widget-new_tempCol__MZVLD",highTemp:"weather-widget-new_highTemp__6C4hd",lowTemp:"weather-widget-new_lowTemp__PC9oU",tempLabel:"weather-widget-new_tempLabel__8hT_G",cardBack:"weather-widget-new_cardBack__xTjVN",cardMiddle:"weather-widget-new_cardMiddle__jvyy1"}},53905:e=>{e.exports={srOnly:"actions-menu_srOnly__xJA_u",icon:"actions-menu_icon__fcwV_",popoverContent:"actions-menu_popoverContent__nCufm",deleteButton:"actions-menu_deleteButton__RjwCW"}},58729:e=>{e.exports={header:"countdown-widget-main_header__XbkZq",content:"countdown-widget-main_content__3ZxC7",mainContainer:"countdown-widget-main_mainContainer__O3bLg",leftColumn:"countdown-widget-main_leftColumn__TZ6zs",title:"countdown-widget-main_title__WwG6v",bottomSection:"countdown-widget-main_bottomSection__h89yO",numberSection:"countdown-widget-main_numberSection__NGY9c",labelRow:"countdown-widget-main_labelRow__LrOdc",number:"countdown-widget-main_number__X7k1y",daysLabel:"countdown-widget-main_daysLabel__dM1Ol",labelSection:"countdown-widget-main_labelSection__E15tX",eventLabel:"countdown-widget-main_eventLabel__q4xq8",rightColumn:"countdown-widget-main_rightColumn__TE2jv",dotsGrid:"countdown-widget-main_dotsGrid__dAy11",dot:"countdown-widget-main_dot___CJiG",pastDot:"countdown-widget-main_pastDot__11QhJ",activeDot:"countdown-widget-main_activeDot__xgK4N"}},61014:e=>{e.exports={container:"count-settings_container__b96Q6",cardContainer:"count-settings_cardContainer__kpK5H",currentSettings:"count-settings_currentSettings___G11E",sectionLabel:"count-settings_sectionLabel__uV_c1",settingRow:"count-settings_settingRow__QGBQq",settingLabel:"count-settings_settingLabel__siQKW",settingValue:"count-settings_settingValue__B7pwX",settingValueCapitalize:"count-settings_settingValueCapitalize__rccwH",tabsContainer:"count-settings_tabsContainer__mj1AJ",browserTab:"count-settings_browserTab__ipFLE",activeTab:"count-settings_activeTab__NYTBX",tabContent:"count-settings_tabContent__d2gTw",field:"count-settings_field__TzYUW",titleInput:"count-settings_titleInput__4igFz",dateFields:"count-settings_dateFields__BMllQ",dateField:"count-settings_dateField__ggkWB",previewContainer:"count-settings_previewContainer__XTb7Q",previewActive:"count-settings_previewActive__k_ZS9",previewUpcoming:"count-settings_previewUpcoming__Qb2sU",previewDefault:"count-settings_previewDefault__CLOAB",previewContent:"count-settings_previewContent__YFbZ2",previewIcon:"count-settings_previewIcon__DAZ73",previewTextContainer:"count-settings_previewTextContainer__0Kmu2",previewMessage:"count-settings_previewMessage__WfHD9",previewSubMessage:"count-settings_previewSubMessage__BcPAg",previewDaysContainer:"count-settings_previewDaysContainer__I4ZX6",previewDaysNumber:"count-settings_previewDaysNumber__fBViT",previewDaysLabel:"count-settings_previewDaysLabel__HDgCv",formContainer:"count-settings_formContainer__6rCv6",gridTwoColumns:"count-settings_gridTwoColumns__8Qptb",fieldLabel:"count-settings_fieldLabel__P6K8t",selectTrigger:"count-settings_selectTrigger__1yMwZ",dateButton:"count-settings_dateButton__tefaP",calendarContainer:"count-settings_calendarContainer__D1lBt",calendarWidget:"count-settings_calendarWidget__fF9M_",validationContainer:"count-settings_validationContainer__CH2h8",validationText:"count-settings_validationText__GmVTn",saveButton:"count-settings_saveButton__Kf024",error:"count-settings_error__YaL_y",success:"count-settings_success__d9vNf",saveButtonContent:"count-settings_saveButtonContent__PtO9l",loadingSpinner:"count-settings_loadingSpinner__ePJT6",spin:"count-settings_spin__Qfdrt",saveIcon:"count-settings_saveIcon__zRDDb",saveIconSmall:"count-settings_saveIconSmall__rrIMc"}},65955:e=>{e.exports={resizablePanels:"notes-widget_resizablePanels__m9eF3",resizableLeft:"notes-widget_resizableLeft__2aYJC",resizableHandle:"notes-widget_resizableHandle__50Wfv",resizableRight:"notes-widget_resizableRight__tMugs",notesContainer:"notes-widget_notesContainer__MxqGn",notesListPanel:"notes-widget_notesListPanel__nMYm_",notesListScroll:"notes-widget_notesListScroll__8Uvke",notesListContent:"notes-widget_notesListContent__VER3T",notesEditorPanel:"notes-widget_notesEditorPanel__ubQjm",notesContentPanel:"notes-widget_notesContentPanel__kgnfp",notesEditorHeader:"notes-widget_notesEditorHeader__gSbX4",notesHeaderContent:"notes-widget_notesHeaderContent__3p8tC",notesTitleContainer:"notes-widget_notesTitleContainer__4QUid",notesTitleInput:"notes-widget_notesTitleInput__eAY4E",notesActions:"notes-widget_notesActions__Xb9PQ",saveStatus:"notes-widget_saveStatus__9K9VR",saveStatusContent:"notes-widget_saveStatusContent__c4LLY",saveStatusSaving:"notes-widget_saveStatusSaving__YrIvA",saveStatusSaved:"notes-widget_saveStatusSaved__yOjyh",saveStatusError:"notes-widget_saveStatusError__50t94",saveStatusVisible:"notes-widget_saveStatusVisible__GWlDl",saveStatusIndicator:"notes-widget_saveStatusIndicator__LJg39",saveStatusIndicatorSaving:"notes-widget_saveStatusIndicatorSaving__I7IAn",pulse:"notes-widget_pulse__YOkks",saveStatusIndicatorSaved:"notes-widget_saveStatusIndicatorSaved__G6Uh_",saveStatusIndicatorError:"notes-widget_saveStatusIndicatorError__ZD7wD",notesEditorScroll:"notes-widget_notesEditorScroll__7Xs5P",notesEditorContainer:"notes-widget_notesEditorContainer__RDhwA",notesEmptyState:"notes-widget_notesEmptyState__hjT75",notesEmptyText:"notes-widget_notesEmptyText__TD7OE"}},67179:e=>{e.exports={container:"dock-content_container__DMvyu",containerVertical:"dock-content_containerVertical__p_Ad6",containerHorizontal:"dock-content_containerHorizontal__grQHT",iconButton:"dock-content_iconButton__o2ZIU",iconButtonActive:"dock-content_iconButtonActive__Od9N1",searchContainer:"dock-content_searchContainer__q14aE",searchContainerVertical:"dock-content_searchContainerVertical__xh4QN",searchContainerHorizontal:"dock-content_searchContainerHorizontal__zwrDM",searchInput:"dock-content_searchInput__2ZX2l",aiButtonActive:"dock-content_aiButtonActive__D4226",icon:"dock-content_icon__FL8J7"}},68800:(e,t,n)=>{"use strict";n.d(t,{SkipOnboardingHandler:()=>r});var a=n(12115),s=n(20063),i=n(97113);function r(){let e=(0,s.useSearchParams)(),{hasSeenOnboarding:t,completeOnboarding:n}=(0,i.t)();return(0,a.useEffect)(()=>{let a=e.get("skipOnboarding"),s=e.get("expandAll");"true"!==a||t||n({userName:"User",agentName:"Toby"}),"true"===s&&setTimeout(()=>{document.querySelectorAll('[data-widget-collapsed="true"]').forEach(e=>{e instanceof HTMLElement&&e.click()}),document.querySelectorAll(".cursor-col-resize").forEach(e=>{let t=new MouseEvent("mousedown",{bubbles:!0,clientX:500});e.dispatchEvent(t),setTimeout(()=>{let e=new MouseEvent("mouseup",{bubbles:!0});document.dispatchEvent(e)},100)})},1e3)},[e,t,n]),null}},76813:(e,t,n)=>{"use strict";n.d(t,{A:()=>l,D:()=>c});var a=n(95155),s=n(12115),i=n(21381),r=n(30181);let o=(0,s.createContext)(void 0);function l(){let e=(0,s.useContext)(o);if(void 0===e)throw Error("useAuth must be used within an ExtensionAuthProvider");return e}function c(e){let{children:t}=e;console.log("ExtensionAuthProvider: Component rendering");let[n,l]=(0,s.useState)(null),[c,d]=(0,s.useState)(null),[u,g]=(0,s.useState)(!0),[m]=(0,s.useState)(()=>(console.log("ExtensionAuthProvider: Creating Supabase client"),(0,i.createExtensionClient)()));(0,s.useEffect)(()=>{let e;if(console.log("ExtensionAuthProvider: useEffect triggered!"),!m){console.warn("ExtensionAuthProvider: No supabase client available, working offline"),g(!1);return}let t=!0;return(async()=>{console.log("ExtensionAuthProvider: Checking for existing session in storage");try{var n;let a=m.auth.getSession(),s=new Promise((t,n)=>{e=setTimeout(()=>{n(Error("Session check timeout"))},5e3)}),{data:{session:i},error:o}=await Promise.race([a,s]);if(clearTimeout(e),!t)return;if(console.log("ExtensionAuthProvider: Session check result:",{hasSession:!!i,hasUser:!!(null==i?void 0:i.user),email:null==i||null==(n=i.user)?void 0:n.email,error:null==o?void 0:o.message}),i&&i.user){let e=localStorage.getItem("session_id");e||(e=crypto.randomUUID(),localStorage.setItem("session_id",e)),(0,r.AA)(e,i.user,i),d(i),l(i.user),console.log("ExtensionAuthProvider: User set:",i.user.email)}else{let e=localStorage.getItem("session_id");e&&(localStorage.removeItem("session_id"),(0,r.dF)(e)),d(null),l(null),console.log("ExtensionAuthProvider: No active session in storage")}}catch(t){console.warn("ExtensionAuthProvider: Error checking session (extension mode):",t),e&&clearTimeout(e);try{let e=localStorage.getItem("sb-qclvzjiyglvxtctauyhb-auth-token");if(e){let t=JSON.parse(e);(null==t?void 0:t.user)&&(null==t?void 0:t.access_token)&&(console.log("ExtensionAuthProvider: Using cached session data"),l(t.user),d(t))}}catch(e){console.warn("ExtensionAuthProvider: Error reading cached session:",e)}d(null),l(null)}finally{t&&(g(!1),console.log("ExtensionAuthProvider: Initial load complete"))}})(),console.log("ExtensionAuthProvider: Skipping auth state listener for extension mode"),()=>{console.log("ExtensionAuthProvider: Cleaning up"),t=!1,e&&clearTimeout(e)}},[m]);let h=async e=>{if(!m)throw console.warn("ExtensionAuthProvider: Sign in not available in offline mode"),Error("Authentication not available in offline mode");try{let{error:t}=await m.auth.signInWithOAuth({provider:e,options:{redirectTo:"".concat(window.location.origin,"/auth/callback"),scopes:"openid email profile https://www.googleapis.com/auth/calendar.readonly https://www.googleapis.com/auth/calendar.events.readonly",queryParams:{access_type:"offline",prompt:"consent"},skipBrowserRedirect:!1}});if(t)throw console.error("Error signing in:",t),t}catch(e){if(console.error("ExtensionAuthProvider: Sign in failed:",e),e instanceof Error&&e.message.includes("Connection"))throw Error("Network connection required for authentication. Please check your internet connection and try again.");throw e}},_=async()=>{let e=localStorage.getItem("session_id");e&&((0,r.dF)(e),localStorage.removeItem("session_id"));try{localStorage.removeItem("sb-qclvzjiyglvxtctauyhb-auth-token")}catch(e){console.warn("Error clearing cached session data:",e)}if(d(null),l(null),!m)return void console.warn("ExtensionAuthProvider: Sign out completed (offline mode)");try{let{error:e}=await m.auth.signOut();e&&(console.error("Error signing out from Supabase:",e),console.warn("Local sign out completed despite Supabase error"))}catch(e){console.error("ExtensionAuthProvider: Sign out failed:",e),console.warn("Local sign out completed despite network error")}};return(0,a.jsx)(o.Provider,{value:{user:n,session:c,signIn:h,signOut:_,loading:u},children:t})}},78817:(e,t,n)=>{"use strict";n.d(t,{DashboardClient:()=>eX});var a=n(95155),s=n(12115),i=n(18344),r=n(58415),o=n(25016),l=n(33789),c=n(67888),d=n(69452),u=n(67179),g=n.n(u);function m(e){let{showSearch:t,searchQuery:n,setSearchQuery:s,showSettings:i,setShowSettings:r,setShowSearch:u,isVertical:m}=e,{isChatOpen:h,openChat:_,closeChat:p}=(0,d.v)();return(0,a.jsxs)("div",{className:(0,o.cn)(g().container,m?g().containerVertical:g().containerHorizontal),children:[(0,a.jsx)("button",{onClick:()=>u(!t),className:(0,o.cn)(g().iconButton,t&&g().iconButtonActive),children:(0,a.jsx)("span",{className:g().icon,children:"\uD83D\uDD0D"})}),(0,a.jsx)(c.I,{onClick:()=>{h?p():_()},className:(0,o.cn)(h&&g().aiButtonActive)}),t&&(0,a.jsxs)("div",{className:(0,o.cn)(g().searchContainer,m?g().searchContainerVertical:g().searchContainerHorizontal),children:[(0,a.jsx)(l.p,{type:"text",placeholder:"Search...",value:n,onChange:e=>s(e.target.value),className:g().searchInput}),n&&(0,a.jsx)("button",{onClick:()=>s(""),className:g().iconButton,children:(0,a.jsx)("span",{className:g().icon,children:"\xd7"})})]})]})}var h=n(59690),_=n(26497),p=n(48687),v=n.n(p);let w=[{date:"Tuesday 14th July",location:"Sydney, NSW",temperature:"28",condition:"Cloudy with low chance of rain",high:"29",low:"6"},{date:"Wednesday 15th July",location:"Sydney, NSW",temperature:"26",condition:"Partly cloudy",high:"27",low:"5"},{date:"Thursday 16th July",location:"Sydney, NSW",temperature:"24",condition:"Light rain",high:"25",low:"4"}];function x(){let[e,t]=(0,s.useState)(w),n=(0,s.useRef)(null),[i,o]=(0,s.useState)(null),l=()=>{i||(o(e[e.length-1]),t(e=>e.slice(0,-1)))};return(0,a.jsx)(r.P.div,{ref:n,className:v().container,whileHover:"hover",initial:"rest",animate:"rest",children:(0,a.jsx)(_.N,{onExitComplete:()=>{i&&(t(e=>[i,...e]),o(null))},children:e.map((e,t)=>t>2?null:(0,a.jsx)(r.P.div,{layout:!0,style:{position:"absolute",left:"50%",width:"calc(100% - 20px)",height:"calc(100% - 40px)",transform:"translateX(-50%)",zIndex:0===t?1:1===t?2:3},animate:{top:0===t?10:1===t?20:40},transition:{type:"spring",stiffness:120,damping:20},children:(0,a.jsx)(r.P.div,{layout:!0,style:{width:"100%",height:"100%",transformOrigin:0===t?"bottom right":1===t?"bottom left":"center"},variants:{rest:{rotate:0},hover:{rotate:0===t?8:1===t?-12:0}},transition:{layout:{type:"spring",stiffness:200,damping:30,mass:1.2},rotate:{type:"spring",stiffness:200,damping:30,mass:1.2},default:{type:"spring",stiffness:200,damping:30,mass:1.2}},children:(0,a.jsxs)(r.P.div,{className:v().card,style:{width:"100%",height:"100%",transformOrigin:"top center",cursor:"pointer"},animate:{scale:0===t?.64:1===t?.8:1,opacity:2===t?1:1===t?.7:.5,rotate:0},exit:{y:100,opacity:0,scale:.9},transition:{type:"spring",stiffness:120,damping:20},whileTap:{scale:.98},onClick:l,children:[(0,a.jsxs)("div",{className:v().cardHeader,children:[(0,a.jsx)("div",{className:v().date,children:e.date}),(0,a.jsx)("div",{className:v().location,children:e.location})]}),(0,a.jsx)("div",{className:v().cardCenter}),(0,a.jsxs)("div",{className:v().cardFooter,children:[(0,a.jsxs)("div",{className:v().mainTempCol,children:[(0,a.jsxs)("div",{className:v().temperature,children:[e.temperature,"\xb0"]}),(0,a.jsx)("div",{className:v().condition,children:e.condition})]}),(0,a.jsxs)("div",{className:v().tempGroup,children:[(0,a.jsxs)("div",{className:v().tempCol,children:[(0,a.jsxs)("div",{className:v().highTemp,children:[e.high,"\xb0"]}),(0,a.jsx)("div",{className:v().tempLabel,children:"High"})]}),(0,a.jsxs)("div",{className:v().tempCol,children:[(0,a.jsxs)("div",{className:v().lowTemp,children:[e.low,"\xb0"]}),(0,a.jsx)("div",{className:v().tempLabel,children:"Low"})]})]})]})]})})},e.date))})})}var f=n(42592),y=n.n(f),j=n(10179),N=n(25891);let b=()=>"undefined"!=typeof globalThis&&"chrome"in globalThis?globalThis.chrome:null,S=()=>{var e;let t=b();return(null==t||null==(e=t.runtime)?void 0:e.id)!==void 0},C=function(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=b();return(null==n||null==(e=n.runtime)?void 0:e.getURL)?n.runtime.getURL(t):t.startsWith("/")?t:"/".concat(t)},T=async(e,t)=>{if(!S())return null;try{let n=new FileReader;return new Promise((a,s)=>{n.onload=async()=>{try{let s=n.result,i="audio_".concat(t,"_").concat(Date.now());await ((e,t)=>new Promise((n,a)=>{var s;let i=b();if(null==i||null==(s=i.storage)?void 0:s.local)i.storage.local.set({[e]:t},()=>{i.runtime.lastError?a(i.runtime.lastError):n()});else try{localStorage.setItem(e,JSON.stringify(t)),n()}catch(e){a(e)}}))(i,{data:s,filename:t,timestamp:Date.now(),type:e.type}),a(i)}catch(e){s(e)}},n.onerror=()=>s(n.error),n.readAsDataURL(e)})}catch(e){return console.error("Failed to save audio to extension storage:",e),null}},k=()=>{let e=(()=>{var e;let t=b();return(null==t||null==(e=t.runtime)?void 0:e.id)||null})();return{isExtension:S(),extensionId:e,baseUrl:S()?C():window.location.origin,storageType:S()?"chrome-storage":"localStorage",canAccessFiles:S(),allowsEval:!S()}};var E=n(46276),D=n(56414),I=n(76813);function A(){let e=!!(window.chrome&&window.chrome.runtime&&window.chrome.runtime.id),t="chrome-extension:"===window.location.protocol;return e||t||!0}async function B(){if(A()){let{createExtensionClient:e}=await Promise.resolve().then(n.bind(n,21381));return e()}{let{createClient:e}=await Promise.resolve().then(n.bind(n,8525));return e()}}var P=n(82180);function M(e){let{className:t}=e,[n,i]=(0,s.useState)(!1),[r,l]=(0,s.useState)(!1),[c,d]=(0,s.useState)(!1),[u,g]=(0,s.useState)(null),{toast:m}=(0,E.dj)(),h=A(),_=(0,D.A)(),p=(0,I.A)(),{user:v}=h?p:_;(0,s.useEffect)(()=>{(async()=>{g(await B())})()},[]);let{state:w,duration:x,audioBlob:f,isMuted:b,startRecording:S,pauseRecording:C,resumeRecording:M,stopRecording:z,toggleMute:L,transcribeAudio:R,saveAudioLocally:O,reset:F}=function(){let{onTranscriptionComplete:e,onError:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[n,a]=(0,s.useState)("idle"),[i,r]=(0,s.useState)(0),[o,l]=(0,s.useState)(null),[c,d]=(0,s.useState)(!1),u=(0,s.useRef)(null),g=(0,s.useRef)(null),m=(0,s.useRef)([]),h=(0,s.useRef)(null),_=(0,s.useCallback)(()=>{h.current=setInterval(()=>{r(e=>e+1)},1e3)},[]),p=(0,s.useCallback)(()=>{h.current&&(clearInterval(h.current),h.current=null)},[]),v=(0,s.useCallback)(async()=>{a("requesting-permission");try{return g.current=await navigator.mediaDevices.getUserMedia({audio:!0}),!0}catch(n){console.error("Error accessing microphone:",n),a("idle");let e="Failed to access microphone. Please check permissions.";return"NotAllowedError"===n.name?e="Microphone access denied. Please allow microphone permissions in your browser settings and try again.":"NotFoundError"===n.name?e="No microphone found. Please connect a microphone and try again.":"NotSupportedError"===n.name?e="Microphone access is not supported in this browser.":"NotReadableError"===n.name?e="Microphone is already in use by another application. Please close other apps using the microphone and try again.":"SecurityError"===n.name&&(e="Microphone access blocked due to security restrictions. Please ensure you are using HTTPS or localhost."),null==t||t(e),!1}},[t]),w=(0,s.useCallback)(async()=>{if(!g.current&&!await v()||!g.current)return;m.current=[],l(null),r(0);let e=new MediaRecorder(g.current,{mimeType:MediaRecorder.isTypeSupported("audio/webm")?"audio/webm":"audio/mp4"});e.ondataavailable=e=>{console.log("Data available:",e.data.size),e.data.size>0&&m.current.push(e.data)},e.onstop=()=>{console.log("MediaRecorder stopped, chunks:",m.current.length);let t=new Blob(m.current,{type:e.mimeType});console.log("Created audio blob, size:",t.size),l(t)},u.current=e,e.start(1e3),a("recording"),_()},[v,_,t]),x=(0,s.useCallback)(()=>{u.current&&"recording"===n&&(u.current.pause(),a("paused"),p())},[n,p]),f=(0,s.useCallback)(()=>{u.current&&"paused"===n&&(u.current.resume(),a("recording"),_())},[n,_]),y=(0,s.useCallback)(()=>{console.log("stopRecording called, mediaRecorder exists:",!!u.current),u.current&&(u.current.stop(),p()),g.current&&(g.current.getTracks().forEach(e=>e.stop()),g.current=null),a("processing")},[p]),j=(0,s.useCallback)(async()=>{if(console.log("transcribeAudio called, audioBlob:",!!o),!o){console.error("No audio blob available"),null==t||t("No audio recorded");return}console.log("Audio blob size:",o.size);try{let n=new FormData;n.append("audio",o,"recording-".concat(Date.now(),".webm"));let s=k(),i=s.isExtension?"".concat(s.baseUrl,"/api/transcribe"):"/api/transcribe",r=await fetch(i,{method:"POST",body:n,headers:s.isExtension&&s.extensionId?{"X-Extension-ID":s.extensionId}:{}});if(console.log("Transcription response status:",r.status),!r.ok){let e=await r.text();console.error("Transcription API error:",e),null==t||t("Transcription failed: ".concat(r.statusText)),a("idle");return}let l=await r.json();console.log("Transcription result:",l),l.success?(console.log("Calling onTranscriptionComplete with:",l.data.text),await (null==e?void 0:e(l.data.text))):(null==t||t(l.error||"Failed to transcribe audio"),a("idle"))}catch(e){console.error("Transcription error:",e),null==t||t("Failed to transcribe audio"),a("idle")}},[o,e,t]),N=(0,s.useCallback)(()=>{g.current&&(g.current.getAudioTracks().forEach(e=>{e.enabled=c}),d(!c))},[c]),b=(0,s.useCallback)(async()=>{if(!o)return;let e="voice-note-".concat(new Date().toISOString().slice(0,19).replace(/:/g,"-"),".webm");if(k().isExtension)try{let t=await T(o,e);t&&console.log("Audio saved to extension storage with key:",t)}catch(t){console.error("Failed to save to extension storage:",t),S(o,e)}else S(o,e)},[o]),S=(e,t)=>{let n=URL.createObjectURL(e),a=document.createElement("a");a.href=n,a.download=t,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(n)};return{state:n,duration:i,audioBlob:o,isMuted:c,startRecording:w,pauseRecording:x,resumeRecording:f,stopRecording:y,toggleMute:N,transcribeAudio:j,saveAudioLocally:b,reset:(0,s.useCallback)(()=>{p(),r(0),l(null),d(!1),a("idle"),g.current&&(g.current.getTracks().forEach(e=>e.stop()),g.current=null)},[p])}}({onTranscriptionComplete:async e=>{console.log("Transcription complete:",e);try{if(!v)return void m({title:"Error",description:"You must be logged in to save voice notes",variant:"destructive"});if(console.log("Saving note for user:",v.id),!u){console.warn("No Supabase client available, saving to local storage");let t={id:Date.now().toString(),title:"Voice Note - ".concat(new Date().toLocaleDateString()),content:[{id:"voice-note-block",type:"paragraph",props:{textColor:"default",backgroundColor:"default",textAlignment:"left"},content:[{type:"text",text:e,styles:{}}],children:[]}],user_id:v.id,created_at:new Date().toISOString()},n=JSON.parse(localStorage.getItem("voice_notes")||"[]");n.push(t),localStorage.setItem("voice_notes",JSON.stringify(n)),m({title:"Success",description:"Voice note saved locally (extension mode)"}),d(!0),setTimeout(()=>{d(!1),l(!1),F()},2e3);return}let{data:t,error:n}=await u.from("notes").insert({title:"Voice Note - ".concat(new Date().toLocaleDateString()),content:[{id:"voice-note-block",type:"paragraph",props:{textColor:"default",backgroundColor:"default",textAlignment:"left"},content:[{type:"text",text:e,styles:{}}],children:[]}],user_id:v.id}).select();if(n){console.error("Error saving note:",n),m({title:"Error",description:"Failed to save voice note",variant:"destructive"});return}console.log("Note saved successfully:",t),m({title:"Success",description:"Voice note saved successfully!"}),console.log("Setting showSuccess to true"),d(!0),setTimeout(()=>{console.log("Hiding success and resetting"),d(!1),l(!1),F()},2e3)}catch(t){console.error("Error processing transcription:",t);let e=t instanceof Error?t.message:String(t);console.error("Error details:",e),m({title:"Error",description:e||"Failed to process transcription",variant:"destructive"}),F()}},onError:e=>{m({title:"Error",description:e,variant:"destructive"})}});(0,s.useEffect)(()=>{"processing"===w&&f&&!c&&(console.log("Audio blob ready, starting transcription..."),R())},[w,f,c,R]);let H=async()=>{l(!0),setTimeout(async()=>{await S()},400)},W=async()=>{console.log("Stop recording clicked"),z()};return(0,a.jsx)(P.Bc,{delayDuration:0,children:(0,a.jsx)(j.Y,{children:(0,a.jsx)("div",{className:(0,o.cn)(y().flipContainer,{[y().flipped]:r},t),children:(0,a.jsxs)("div",{className:y().flipper,children:[(0,a.jsx)("div",{className:y().front,children:(0,a.jsx)("div",{className:y().container,children:(0,a.jsxs)("div",{className:y().content,children:[(0,a.jsx)(N.e,{title:"Recorder",className:"!justify-start"}),(0,a.jsxs)("div",{className:y().body,children:[(0,a.jsx)("div",{className:y().buttonContainer,children:(0,a.jsx)("button",{onClick:H,onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),className:(0,o.cn)(y().button,"group"),children:(0,a.jsxs)("div",{className:y().buttonOuter,children:[(0,a.jsx)("div",{className:y().buttonBackground}),(0,a.jsx)("div",{className:y().buttonBorder}),(0,a.jsx)("div",{className:y().buttonTopHighlight}),(0,a.jsx)("div",{className:(0,o.cn)(y().recordingDot,{[y().recordingDotHover]:n})}),(0,a.jsx)("div",{className:y().microphoneIcon,children:(0,a.jsx)("span",{className:y().micIcon,children:"â€¢"})})]})})}),(0,a.jsx)("p",{className:y().bodyText,children:"Start a voice note"})]})]})})}),(0,a.jsx)("div",{className:y().back,children:(0,a.jsx)("div",{className:y().container,children:(0,a.jsxs)("div",{className:y().content,children:[(0,a.jsx)(N.e,{title:"Recorder",className:"!justify-start"}),(0,a.jsx)("div",{className:y().recordingBody,children:"processing"!==w||c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:y().waveformContainer,children:(()=>{let e=[];for(let t=0;t<20;t++){let n="".concat(.05*t,"s");e.push((0,a.jsx)("div",{className:(0,o.cn)(y().waveformBar,{[y().waveformBarActive]:"recording"===w}),style:{animationDelay:n}},t))}return e})()}),(0,a.jsx)("div",{className:y().timerContainer,children:(0,a.jsx)("p",{className:y().timer,children:(e=>{let t=Math.floor(e/60);return"".concat(t.toString().padStart(2,"0"),":").concat((e%60).toString().padStart(2,"0"))})(x)})}),(0,a.jsxs)("div",{className:y().recordingControls,children:["requesting-permission"===w&&(0,a.jsx)("div",{className:y().permissionMessage,children:(0,a.jsx)("p",{children:"Requesting microphone permission..."})}),"recording"===w&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(P.m_,{delayDuration:0,children:[(0,a.jsx)(P.k$,{asChild:!0,children:(0,a.jsx)("button",{onClick:L,className:(0,o.cn)(y().controlButton,{[y().muteButtonActive]:b}),children:(0,a.jsx)("div",{className:(0,o.cn)(y().controlButtonInner,{[y().muteButtonInnerActive]:b}),children:(0,a.jsx)("span",{className:y().controlIcon,children:"â€¢"})})})}),(0,a.jsx)(P.ZI,{side:"top",children:(0,a.jsx)("p",{children:b?"Unmute":"Mute"})})]}),(0,a.jsxs)(P.m_,{delayDuration:0,children:[(0,a.jsx)(P.k$,{asChild:!0,children:(0,a.jsx)("button",{onClick:C,className:y().controlButton,children:(0,a.jsx)("div",{className:y().controlButtonInner,children:(0,a.jsx)("span",{className:y().controlIcon,children:"â€¢"})})})}),(0,a.jsx)(P.ZI,{side:"top",children:(0,a.jsx)("p",{children:"Pause"})})]}),(0,a.jsxs)(P.m_,{delayDuration:0,children:[(0,a.jsx)(P.k$,{asChild:!0,children:(0,a.jsx)("button",{onClick:W,className:(0,o.cn)(y().controlButton,y().doneButton),children:(0,a.jsx)("div",{className:y().controlButtonInner,children:(0,a.jsx)("span",{className:y().controlIcon,children:"âœ“"})})})}),(0,a.jsx)(P.ZI,{side:"top",children:(0,a.jsx)("p",{children:"Done"})})]})]}),"paused"===w&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(P.m_,{delayDuration:0,children:[(0,a.jsx)(P.k$,{asChild:!0,children:(0,a.jsx)("button",{onClick:L,className:(0,o.cn)(y().controlButton,{[y().muteButtonActive]:b}),children:(0,a.jsx)("div",{className:(0,o.cn)(y().controlButtonInner,{[y().muteButtonInnerActive]:b}),children:(0,a.jsx)("span",{className:y().controlIcon,children:"â€¢"})})})}),(0,a.jsx)(P.ZI,{side:"top",children:(0,a.jsx)("p",{children:b?"Unmute":"Mute"})})]}),(0,a.jsxs)(P.m_,{delayDuration:0,children:[(0,a.jsx)(P.k$,{asChild:!0,children:(0,a.jsx)("button",{onClick:M,className:y().controlButton,children:(0,a.jsx)("div",{className:y().controlButtonInner,children:(0,a.jsx)("span",{className:y().controlIcon,children:"â€¢"})})})}),(0,a.jsx)(P.ZI,{side:"top",children:(0,a.jsx)("p",{children:"Resume"})})]}),(0,a.jsxs)(P.m_,{delayDuration:0,children:[(0,a.jsx)(P.k$,{asChild:!0,children:(0,a.jsx)("button",{onClick:W,className:(0,o.cn)(y().controlButton,y().doneButton),children:(0,a.jsx)("div",{className:y().controlButtonInner,children:(0,a.jsx)("span",{className:y().controlIcon,children:"âœ“"})})})}),(0,a.jsx)(P.ZI,{side:"top",children:(0,a.jsx)("p",{children:"Done"})})]})]}),c&&(0,a.jsxs)("div",{className:y().successContainer,children:[(0,a.jsx)("span",{className:y().controlIcon,children:"âœ“"}),(0,a.jsx)("span",{className:y().doneText,children:"Note saved!"})]})]})]}):(0,a.jsxs)("div",{className:y().transcribingWrapper,children:[(0,a.jsxs)("div",{className:y().transcribingContent,children:[(0,a.jsx)("div",{className:y().gifPlaceholder,children:(0,a.jsxs)("div",{className:y().animatedDotsContainer,children:[(0,a.jsx)("div",{className:y().animatedDot}),(0,a.jsx)("div",{className:y().animatedDot}),(0,a.jsx)("div",{className:y().animatedDot}),(0,a.jsx)("div",{className:y().animatedDot})]})}),(0,a.jsx)("h2",{className:y().transcribingTitle,children:"Transcribing note..."}),(0,a.jsxs)("p",{className:y().transcribingSubtitle,children:["Transcriptions are saved as a",(0,a.jsx)("br",{}),"note once complete."]})]}),(0,a.jsx)("button",{onClick:()=>{F(),l(!1),d(!1)},className:y().okButton,children:"OK"})]})})]})})})]})})})})}var z=n(22454),L=n(26467),R=n(71163),O=n(14187),F=n(58576),H=n(70063),W=n(2327),U=n(13886),G=n(60776),V=n(58293),J=n(41401),Y=n.n(J);function Z(e){let{event:t,isCurrent:n}=e,s=e=>e?e.includes("T")?(0,L.H)(e):new Date(parseInt(e)):new Date,i=s(t.start),r=s(t.end);return(0,a.jsxs)("div",{className:(0,o.cn)("widget-list-item widget-list-item--schedule",Y().eventCard,{[Y().eventCardCurrent]:n,[Y().eventCardDefault]:!n}),children:[(0,a.jsx)("div",{className:Y().eventTitle,children:t.title}),(0,a.jsxs)("div",{className:Y().eventTime,children:[(0,R.GP)(i,"p")," â€“ ",(0,R.GP)(r,"p")]})]})}function X(e){let{dayKey:t,events:n,now:i,isCurrentDay:r,currentEvent:o,todayRef:l,onVisible:c}=e,d=(0,s.useRef)(null),u=(0,s.useRef)(c);return(0,s.useEffect)(()=>{u.current=c},[c]),(0,s.useEffect)(()=>{let e=d.current||(null==l?void 0:l.current);if(!e)return;let n=()=>{var n;let a=e.getBoundingClientRect(),s=null==(n=e.closest(".overflow-y-auto"))?void 0:n.getBoundingClientRect();s&&a.top<=s.top+100&&a.bottom>=s.top+50&&u.current(t)},a=e.closest(".overflow-y-auto");if(a)return a.addEventListener("scroll",n),n(),()=>{a.removeEventListener("scroll",n)}},[t,l]),(0,a.jsxs)("div",{ref:l||d,className:Y().daySection,children:[r&&(0,a.jsx)("div",{className:Y().currentTimeIndicator,style:{top:"40%"},children:(0,a.jsxs)("div",{className:Y().relativeContainer,children:[(0,a.jsx)("div",{className:Y().currentTimeLine}),(0,a.jsx)("div",{className:Y().currentTimeDot})]})}),(0,a.jsx)("div",{className:Y().dayHeader,children:(0,R.GP)((0,L.H)(t),"EEEE do 'of' MMMM")}),n.map(e=>(0,a.jsx)(Z,{event:e,isCurrent:(null==o?void 0:o.id)===e.id},e.id))]})}function q(){let e=A(),t=(0,D.A)(),n=(0,I.A)(),{loading:i}=e?n:t,r="undefined"!=typeof document&&document.cookie.includes("sb-qclvzjiyglvxtctauyhb-auth-token"),{data:o=[],isLoading:l,error:c}=(0,z.I)({queryKey:["schedule"],enabled:!i||r,queryFn:async()=>{try{let e=await W.F.get("/api/calendar");if(!e.ok){let t=await e.json();throw Error(t.error||"Failed to fetch schedule")}let t=await e.json();if(t.success&&t.data&&0===t.data.length&&t.message&&t.message.includes("Try reconnecting"))throw Error("Google Calendar not connected");let n=t.data||[];if(!Array.isArray(n))return[];return n.map(e=>({id:e.id,title:e.title,start:e.start||e.startTime||"",end:e.end||e.endTime||"",description:e.description,location:e.location,allDay:e.allDay,color:e.color,calendarId:e.calendarId,calendarName:e.calendarName,source:e.source||"google"}))}catch(e){throw console.error("Error fetching schedule:",e),e}},retry:!1}),[d,u]=(0,s.useState)(new Date),[g,m]=(0,s.useState)(null),h=(0,s.useRef)(null);(0,s.useEffect)(()=>{let e=setInterval(()=>u(new Date),6e4);return()=>clearInterval(e)},[]);let _=(0,s.useMemo)(()=>{let e=new Date(new Date().getTime()-12096e5);return[...o].filter(t=>{try{return("string"==typeof t.start?t.start.includes("T")?(0,L.H)(t.start):new Date(parseInt(t.start)):new Date)>=new Date(e.getFullYear(),e.getMonth(),e.getDate())}catch(e){return!1}}).sort((e,t)=>{let n="string"==typeof e.start?e.start.includes("T")?(0,L.H)(e.start):new Date(parseInt(e.start)):new Date,a="string"==typeof t.start?t.start.includes("T")?(0,L.H)(t.start):new Date(parseInt(t.start)):new Date;return n.getTime()-a.getTime()}).reduce((e,t)=>{try{let n="string"==typeof t.start?t.start.includes("T")?(0,L.H)(t.start):new Date(parseInt(t.start)):new Date,a=(0,R.GP)(n,"yyyy-MM-dd");e[a]||(e[a]=[]),e[a].push(t)}catch(e){console.error("Error processing event date:",e,t)}return e},{})},[o]),p=(0,s.useMemo)(()=>Object.keys(_).sort(),[_]),v=(0,s.useMemo)(()=>_[(0,R.GP)(new Date,"yyyy-MM-dd")]||[],[_]).find(e=>{let t=e=>e?e.includes("T")?(0,L.H)(e):new Date(parseInt(e)):new Date,n=t(e.start),a=t(e.end);return(0,O.d)(d,n)&&(0,F.Y)(d,a)});if((0,s.useEffect)(()=>{g||m((0,R.GP)(new Date,"yyyy-MM-dd"))},[g]),(0,s.useEffect)(()=>{!l&&h.current&&setTimeout(()=>{var e;null==(e=h.current)||e.scrollIntoView({block:"start",behavior:"smooth"})},100)},[l]),i&&!r||l)return(0,a.jsx)(G.O,{className:"schedule"});if(c){let e=c.message.includes("Google Calendar not connected");return(0,a.jsxs)(V.u,{children:[(0,a.jsx)(N.e,{title:"Schedule"}),(0,a.jsx)("div",{className:Y().errorContainer,children:e?(0,a.jsx)(U.p,{renderIcon:()=>(0,a.jsx)("span",{className:Y().calendarIcon,children:"â—Š"}),title:"Connect your calendar",description:"See your schedule at a glance by connecting your Google Calendar.",action:{label:"Connect Calendar",onClick:async()=>{try{console.log("Connecting calendar - starting OAuth flow...");let e=await B(),{data:t,error:n}=await e.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(window.location.origin,"/auth/callback"),scopes:"openid email profile https://www.googleapis.com/auth/calendar.readonly",queryParams:{access_type:"offline",prompt:"consent"}}});if(console.log("OAuth response:",{data:t,error:n}),n){console.error("Error connecting calendar:",n),console.log("Trying direct Google OAuth...");let e="https://accounts.google.com/o/oauth2/v2/auth?"+"client_id=".concat(encodeURIComponent("301293553612-42c89kj4s39tckdevgv5o6dttsfulnml.apps.googleusercontent.com"),"&")+"redirect_uri=".concat(encodeURIComponent(window.location.origin+"/auth/callback"),"&")+"response_type=code&"+"scope=".concat(encodeURIComponent("openid email profile https://www.googleapis.com/auth/calendar.readonly"),"&")+"access_type=offline&prompt=consent";console.log("Redirecting to:",e),window.location.href=e}else console.log("OAuth initiated successfully")}catch(e){console.error("Failed to connect calendar:",e)}}}}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:Y().errorTitle,children:"Error loading schedule"}),(0,a.jsx)("p",{className:Y().errorMessage,children:c.message})]})})]})}let w=g?(0,L.H)(g):new Date;return(0,a.jsx)(V.u,{children:(0,a.jsxs)("div",{className:Y().container,children:[(0,a.jsxs)("div",{className:Y().sidebar,children:[(0,a.jsx)("div",{className:Y().sidebarHeader,children:(0,a.jsx)("h2",{className:"widget-title",children:"Schedule"})}),(0,a.jsxs)("div",{className:Y().sidebarContent,children:[(0,a.jsx)("div",{}),(0,a.jsx)("div",{}),(0,a.jsxs)("div",{className:Y().sidebarFooter,children:[(0,a.jsxs)("div",{className:Y().dayDateContainer,children:[(0,a.jsxs)("div",{className:Y().dayText,children:[(0,H.c)(w)&&(0,a.jsx)("div",{className:Y().todayDot}),(0,R.GP)(w,"EEE")]}),(0,a.jsx)("div",{className:"bigNumber",style:{marginBottom:"0px",lineHeight:"0.9"},children:(0,R.GP)(w,"dd")})]}),(0,a.jsx)("div",{className:Y().monthText,children:(0,R.GP)(w,"MMMM")})]})]})]}),(0,a.jsx)("div",{className:Y().rightContent,children:(0,a.jsx)("div",{className:Y().scrollContainer,children:0===p.length?(0,a.jsx)(U.p,{renderIcon:()=>(0,a.jsx)("span",{className:Y().calendarIcon,children:"â—Š"}),title:"No events scheduled",description:"Your calendar is clear. Connect your Google Calendar to see upcoming events.",className:Y().emptyStateContainer}):p.map(e=>{let t=_[e],n=(0,H.c)((0,L.H)(e));return(0,a.jsx)(X,{dayKey:e,events:t,now:d,isCurrentDay:n,currentEvent:v,todayRef:n?h:null,onVisible:m},e)})})})]})})}var K=n(53350),Q=n(68),$=n(93366),ee=n(50316),et=n(75513),en=n(92381);let ea=async e=>new Promise(e=>{"undefined"!=typeof chrome&&chrome.storage?chrome.storage.sync.get(["paydaySettings"],t=>{e({data:t.paydaySettings||null,serverError:null})}):e({data:null,serverError:null})}),es=async e=>new Promise(t=>{"undefined"!=typeof chrome&&chrome.storage?chrome.storage.sync.set({paydaySettings:e},()=>{t({data:e,serverError:null})}):t({data:e,serverError:null})});var ei=n(58729),er=n.n(ei),eo=n(20063);let el={weekly:7,fortnightly:14,monthly:30,annual:365};function ec(e){let{variant:t="vertical"}=e;(0,eo.useRouter)();let[n,i]=(0,s.useState)({nextPayday:new Date,daysLeft:el.fortnightly,recurrenceInDays:el.fortnightly}),{data:o,isLoading:l}=(0,z.I)({queryKey:["payday-settings"],queryFn:async()=>{let e=await ea({});if(null==e?void 0:e.serverError)throw Error(e.serverError);return e.data}});(0,s.useEffect)(()=>{if(!o)return;let{countdownMode:e,manualCount:t,endDate:n,startDate:a,paydayFrequency:s}=o;if("manual-count"===e)i({nextPayday:new Date,daysLeft:t||0,recurrenceInDays:14});else if("date-range"===e||o.paydayDate){let e=(0,$.o)(new Date);if("none"===s){let t=new Date(n||o.paydayDate),a=(0,ee.c)((0,$.o)(t),e);i({nextPayday:t,daysLeft:Math.max(0,a),recurrenceInDays:Math.max(14,Math.abs(a))})}else if(s&&(n||o.paydayDate)){let t=new Date(a||o.paydayDate),n=el[s],r=new Date(t);for(;(0,F.Y)(r,e)||r.getTime()===e.getTime();)r="monthly"===s?(0,et.P)(r,1):"annual"===s?new Date(r.setFullYear(r.getFullYear()+1)):(0,en.f)(r,n);let l=(0,ee.c)(r,e);i({nextPayday:r,daysLeft:l,recurrenceInDays:n})}}},[o]);let c=(null==o?void 0:o.countdownTitle)||"Swount",{daysLeft:d,recurrenceInDays:u}=n,g=Math.max(d,u),m=g-d,h=(0,K.d)(null!=d?d:0);(0,Q.G)(h,e=>Math.round(e));let[p,v]=(0,s.useState)(null!=d?d:0),w=p.toString();if(l)return(0,a.jsx)(G.O,{className:"Countdown",minHeight:"h-[280px]"});let x=(null==o?void 0:o.startDate)&&(null==o?void 0:o.endDate),f=x?(0,ee.c)(new Date(o.endDate),new Date(o.startDate)):0;return(0,a.jsxs)(V.u,{children:[(0,a.jsx)(N.e,{title:"Countdown"}),(0,a.jsx)(V.i,{scrollable:!1,className:er().content,children:(0,a.jsxs)("div",{className:er().mainContainer,children:[(0,a.jsx)(function(e){let{count:t,gap:n=7}=e,i=(0,s.useRef)(null);return(0,s.useLayoutEffect)(()=>{let e=i.current,a=e=>{let t=document.createElement("div");return t.className=s(e),t},s=e=>e<m?er().pastDot:e===g-1?er().activeDot:x&&e>=g-f?er().activeDot:er().dot,r=()=>{var i;let r=e.clientWidth,o=e.clientHeight;if(!r||!o)return;let l=e.children.length;if(l<t)for(let n=l;n<t;n++)e.appendChild(a(n));else for(;e.children.length>t;)null==(i=e.lastChild)||i.remove();for(let t=0;t<e.children.length;t++)e.children[t].className=s(t);let{cols:c,size:d}=((e,t,n,a)=>{let s={rows:1,cols:n,size:0};for(let i=1;i<=n;i++){let r=Math.ceil(n/i),o=Math.floor(Math.min((e-a*(r-1))/r,(t-a*(i-1))/i));o>s.size&&(s={rows:i,cols:r,size:o})}return s})(r,o,t,n);e.style.gap="".concat(n,"px"),e.style.gridTemplateColumns="repeat(".concat(c,", ").concat(d,"px)"),e.style.setProperty("--dot-size","".concat(d,"px"))},o=new ResizeObserver(r);return o.observe(e),r(),()=>o.disconnect()},[t,n,m,g,x,f]),(0,a.jsx)("div",{ref:i,className:er().dotsGrid,style:{display:"grid",placeItems:"center",width:"100%",height:"100%"}})},{count:g,gap:7}),(0,a.jsx)("div",{className:er().bottomSection,children:(0,a.jsxs)("div",{className:er().numberSection,children:[(0,a.jsx)(j.Y,{children:(0,a.jsx)(_.N,{mode:"popLayout",children:(0,a.jsx)(r.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.4,ease:"easeOut"},className:"countdown-number",children:w},p)})}),(0,a.jsxs)("div",{className:er().labelRow,children:[(0,a.jsx)("span",{className:er().daysLabel,children:"Days until"}),(0,a.jsx)("span",{className:er().eventLabel,children:c})]})]})})]})})]})}var ed=n(52680),eu=n(11939),eg=n.n(eu);function em(e){let{notes:t,tasks:n,dockPosition:i,searchQuery:o}=e,l=(0,s.useMemo)(()=>{switch(i){case"top":return{paddingTop:80,paddingRight:24,paddingBottom:24,paddingLeft:24};case"right":return{paddingTop:24,paddingRight:80,paddingBottom:24,paddingLeft:24};case"bottom":default:return{paddingTop:24,paddingRight:24,paddingBottom:80,paddingLeft:24};case"left":return{paddingTop:24,paddingRight:24,paddingBottom:24,paddingLeft:80}}},[i]),{layout:c}=(0,ed.g)(),d=e=>({initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:e},className:eg().panelMotion});return(0,a.jsx)(r.P.div,{animate:{paddingTop:l.paddingTop,paddingRight:l.paddingRight,paddingBottom:l.paddingBottom,paddingLeft:l.paddingLeft},transition:{type:"spring",stiffness:300,damping:30,duration:.6},className:"bento-container",children:"two-row"===c?(0,a.jsxs)(h.YZ,{direction:"vertical",className:"panel-group",children:[(0,a.jsx)(h.Zk,{defaultSize:50,minSize:30,children:(0,a.jsxs)(h.YZ,{direction:"horizontal",className:"panel-group",children:[(0,a.jsx)(h.Zk,{defaultSize:50,minSize:8,children:(0,a.jsx)(r.P.div,{...d(.25),className:"panel-motion",children:t})}),(0,a.jsx)(h.TW,{className:eg().resizeHandleHorizontal}),(0,a.jsx)(h.Zk,{defaultSize:50,minSize:8,children:(0,a.jsx)(r.P.div,{...d(.5),className:"panel-motion",children:n})})]})}),(0,a.jsx)(h.TW,{className:eg().resizeHandleVertical}),(0,a.jsx)(h.Zk,{defaultSize:50,minSize:30,children:(0,a.jsxs)(h.YZ,{direction:"horizontal",className:"panel-group",children:[(0,a.jsx)(h.Zk,{defaultSize:25,children:(0,a.jsx)(r.P.div,{...d(.75),className:"panel-motion",children:(0,a.jsx)(x,{})})}),(0,a.jsx)(h.TW,{className:eg().resizeHandleHorizontal}),(0,a.jsx)(h.Zk,{defaultSize:25,children:(0,a.jsx)(r.P.div,{...d(.85),className:"panel-motion",children:(0,a.jsx)(M,{})})}),(0,a.jsx)(h.TW,{className:eg().resizeHandleHorizontal}),(0,a.jsx)(h.Zk,{defaultSize:25,children:(0,a.jsx)(r.P.div,{...d(1),className:"panel-motion",children:(0,a.jsx)(ec,{})})}),(0,a.jsx)(h.TW,{className:eg().resizeHandleHorizontal}),(0,a.jsx)(h.Zk,{defaultSize:25,children:(0,a.jsx)(r.P.div,{...d(1.25),className:"panel-motion",children:(0,a.jsx)(q,{})})})]})})]}):(0,a.jsxs)(h.YZ,{direction:"horizontal",className:eg().singleRowPanelGroup,children:[(0,a.jsx)(h.Zk,{defaultSize:67,minSize:30,children:(0,a.jsxs)(h.YZ,{direction:"vertical",className:"panel-group",children:[(0,a.jsx)(h.Zk,{defaultSize:60,minSize:25,children:(0,a.jsx)(r.P.div,{...d(.25),className:"panel-motion",children:t})}),(0,a.jsx)(h.TW,{className:eg().resizeHandleVertical}),(0,a.jsx)(h.Zk,{defaultSize:40,minSize:25,children:(0,a.jsxs)(h.YZ,{direction:"horizontal",className:"panel-group",children:[(0,a.jsx)(h.Zk,{defaultSize:33,children:(0,a.jsx)(r.P.div,{...d(.75),className:"panel-motion",children:(0,a.jsx)(x,{})})}),(0,a.jsx)(h.TW,{className:eg().resizeHandleHorizontal}),(0,a.jsx)(h.Zk,{defaultSize:33,children:(0,a.jsx)(r.P.div,{...d(.85),className:"panel-motion",children:(0,a.jsx)(ec,{})})}),(0,a.jsx)(h.TW,{className:eg().resizeHandleHorizontal}),(0,a.jsx)(h.Zk,{defaultSize:33,children:(0,a.jsx)(r.P.div,{...d(1),className:"panel-motion",children:(0,a.jsx)(M,{})})})]})})]})}),(0,a.jsx)(h.TW,{className:eg().resizeHandleInline}),(0,a.jsx)(h.Zk,{defaultSize:33,minSize:8,children:(0,a.jsxs)(h.YZ,{direction:"vertical",className:"panel-group",children:[(0,a.jsx)(h.Zk,{defaultSize:50,minSize:8,children:(0,a.jsx)(r.P.div,{...d(.5),className:"panel-motion",children:n})}),(0,a.jsx)(h.TW,{className:eg().resizeHandleVertical}),(0,a.jsx)(h.Zk,{defaultSize:50,minSize:25,children:(0,a.jsx)(r.P.div,{...d(1.25),className:"panel-motion",children:(0,a.jsx)(q,{})})})]})})]})})}var eh=n(14888),e_=n(97003),ep=n(99776),ev=n(80549),ew=n(15239),ex=n(87022),ef=n.n(ex),ey=n(17549),ej=n.n(ey);function eN(e){let{variant:t="dock"}=e,{layout:n,toggleLayout:s}=(0,ed.g)();return"dock"===t?(0,a.jsx)(P.Bc,{children:(0,a.jsxs)(P.m_,{children:[(0,a.jsx)(P.k$,{asChild:!0,children:(0,a.jsx)(e_.$,{variant:"ghost",size:"icon",onClick:s,className:ej().dockButton,children:(0,a.jsx)("span",{className:ej().icon,children:"â€¢"})})}),(0,a.jsxs)(P.ZI,{children:["Switch to ","two-row"===n?"single-row":"two-row"," layout"]})]})}):(0,a.jsx)(e_.$,{variant:"outline",onClick:s,className:ej().settingsButton,children:"two-row"===n?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:ej().icon,children:"â€¢"}),"Switch to Single Row"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:ej().icon,children:"â€¢"}),"Switch to Two Row"]})})}var eb=n(1989),eS=n.n(eb),eC=n(85284),eT=n.n(eC);let ek=s.forwardRef((e,t)=>{let{className:n,children:s,onValueChange:i,value:r,...l}=e;return(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("select",{className:(0,o.cn)(eT().select,n),ref:t,onChange:i?e=>i(e.target.value):l.onChange,value:r,...l,children:s}),(0,a.jsx)("div",{className:eT().iconContainer,children:(0,a.jsx)("svg",{className:eT().icon,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 9l4-4 4 4m0 6l-4 4-4-4"})})})]})});ek.displayName="Select";let eE=s.forwardRef((e,t)=>{let{className:n,children:a,...s}=e;return null});eE.displayName="SelectTrigger";let eD=s.forwardRef((e,t)=>{let{placeholder:n,...a}=e;return null});eD.displayName="SelectValue";let eI=s.forwardRef((e,t)=>{let{children:n,...s}=e;return(0,a.jsx)(a.Fragment,{children:n})});eI.displayName="SelectContent",s.forwardRef((e,t)=>{let{children:n,label:s,...i}=e;return(0,a.jsx)("optgroup",{ref:t,label:s,...i,children:n})}).displayName="SelectGroup";let eA=s.forwardRef((e,t)=>{let{className:n,children:s,...i}=e;return(0,a.jsx)("option",{ref:t,className:(0,o.cn)(eT().option,n),...i,children:s})});eA.displayName="Select",s.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,a.jsx)("label",{ref:t,className:(0,o.cn)("px-2 py-1.5 text-sm font-semibold",n),...s})}).displayName="SelectLabel";var eB=n(55725),eP=n(97450);function eM(e){let{date:t,onSelect:n,placeholder:s="Pick a date",disabled:i,className:r}=e;return(0,a.jsxs)(eP.AM,{children:[(0,a.jsx)(eP.Wv,{asChild:!0,children:(0,a.jsxs)(e_.$,{variant:"outline",className:(0,o.cn)("w-full justify-between text-left font-normal bg-transparent border border-white/20 text-white rounded-lg hover:bg-white/10",!t&&"text-muted-foreground",r),children:[(0,a.jsx)("span",{className:"mr-2 h-4 w-4",children:"â—Š"}),t?(0,R.GP)(t,"dd/MM/yy"):(0,a.jsx)("span",{children:s})]})}),(0,a.jsx)(eP.hl,{className:"w-auto p-0",align:"start",children:(0,a.jsx)(eB.V,{mode:"single",selected:t,onSelect:n,disabled:i,initialFocus:!0})})]})}var ez=n(61014),eL=n.n(ez);let eR=s.forwardRef((e,t)=>{let{children:n,asChild:i=!1,...r}=e;return(i&&s.Fragment,i)?(0,a.jsx)(a.Fragment,{children:n}):(0,a.jsx)("span",{ref:t,style:{position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",border:"0"},...r,children:n})});eR.displayName="VisuallyHidden";var eO=n(41742),eF=n.n(eO);let eH=[{name:"Display options",description:"Dock, Widget and Background",component:function(){let{layout:e}=(0,ed.g)();return(0,a.jsxs)("div",{className:eS().container,children:[(0,a.jsxs)("div",{className:eS().section,children:[(0,a.jsx)("h2",{className:eS().heading,children:"Layout"}),(0,a.jsx)("p",{className:eS().description,children:"Choose how your widgets are arranged on the screen."}),(0,a.jsxs)("div",{className:eS().layoutContainer,children:[(0,a.jsxs)("div",{className:eS().layoutInfo,children:[(0,a.jsx)("div",{className:eS().layoutTitle,children:"Current Layout"}),(0,a.jsx)("div",{className:eS().layoutSubtitle,children:"two-row"===e?"Two-row grid layout":"Single-row layout"})]}),(0,a.jsx)(eN,{variant:"settings"})]}),(0,a.jsxs)("div",{className:eS().detailsContainer,children:[(0,a.jsxs)("div",{className:eS().detailItem,children:[(0,a.jsx)("strong",{className:eS().detailLabel,children:"Two-row layout:"})," Notes and Tasks span the top half, with Weather, Recorder, Finance, and Schedule widgets arranged in the bottom row."]}),(0,a.jsxs)("div",{className:eS().detailItem,children:[(0,a.jsx)("strong",{className:eS().detailLabel,children:"Single-row layout:"})," Notes takes up most of the left side, with smaller widgets below it, and Tasks and Schedule on the right side."]})]})]}),(0,a.jsxs)("div",{className:eS().section,children:[(0,a.jsx)("h2",{className:eS().heading,children:"Dock & Interface"}),(0,a.jsx)("p",{className:eS().description,children:"Customize the floating dock and interface elements."}),(0,a.jsx)("div",{className:eS().comingSoon,children:"Additional dock and interface customization options coming soon."})]}),(0,a.jsxs)("div",{className:eS().section,children:[(0,a.jsx)("h2",{className:eS().heading,children:"Background"}),(0,a.jsx)("p",{className:eS().description,children:"Personalize your workspace background."}),(0,a.jsx)("div",{className:eS().comingSoon,children:"Background customization options coming soon."})]})]})}},{name:"Notes, Tasks & Voice",description:"Written and Voice notes",component:()=>(0,a.jsx)("div",{children:"Notes Settings"})},{name:"Count",description:"Countdown and recurrence settings",component:function(){let[e,t]=(0,s.useState)("start-end"),[n,i]=(0,s.useState)("weekly"),[r,c]=(0,s.useState)(),[d,u]=(0,s.useState)(),[g,m]=(0,s.useState)(),[h,_]=(0,s.useState)("Countdown"),[p,v]=(0,s.useState)(!1),[w,x]=(0,s.useState)(!1),[f,y]=(0,s.useState)(!1),[j,N]=(0,s.useState)(null),{toast:b}=(0,E.dj)(),S=(0,ep.jE)();(0,s.useEffect)(()=>{!async function(){let e=await ea({});if(e.data){let{paydayDate:n,paydayFrequency:a,countdownTitle:s,startDate:r,endDate:o}=e.data;if(a&&i(a),s&&_(s),r&&o){t("start-end");let e=new Date(r),n=new Date(o);c(e),u(n),m({from:e,to:n}),N({countdownTitle:s||"Countdown",mode:"start-end",startDate:new Date(r),endDate:new Date(o)})}else n&&a&&(t("recurring"),c(new Date(n)),N({countdownTitle:s||"Countdown",mode:"recurring",frequency:a,startDate:new Date(n)}))}}()},[]);let C=async()=>{if(y(!0),"start-end"===e&&(!r||!d))return void b({title:"Error",description:"Please select both start and end dates.",variant:"destructive"});if("recurring"===e&&!r)return void b({title:"Error",description:"Please select a starting date.",variant:"destructive"});v(!0),x(!1);try{let t={countdownTitle:h.trim()||"Countdown",countdownMode:"date-range",paydayFrequency:"start-end"===e?"none":n,..."start-end"===e?{startDate:r,endDate:d,paydayDate:null}:{paydayDate:r,startDate:null,endDate:null}},a=await es(t);a.serverError?b({title:"Error",description:a.serverError,variant:"destructive"}):(N({countdownTitle:h.trim()||"Countdown",mode:e,frequency:"recurring"===e?n:void 0,startDate:r,endDate:d}),x(!0),b({title:"Success",description:"Countdown settings saved successfully"}),await S.invalidateQueries({queryKey:["payday-settings"]}),setTimeout(()=>x(!1),3e3))}catch(e){b({title:"Error",description:"An unexpected error occurred.",variant:"destructive"})}finally{v(!1)}},T=(0,s.useCallback)(e=>{i(e)},[]),k=(0,s.useCallback)(e=>{t(e)},[]);return(0,s.useMemo)(()=>{if("start-end"===e){if(!r||!d)return null;let e=(0,$.o)(new Date),t=(0,ee.c)((0,$.o)(r),e),n=(0,ee.c)((0,$.o)(d),e);return((0,ee.c)((0,$.o)(d),(0,$.o)(r)),n<0)?{status:"ended",message:"Event has ended",days:0}:t>0?{status:"upcoming",message:"".concat(t," days until start"),days:t}:{status:"active",message:"Event in progress",subMessage:"".concat(n," days remaining"),days:n}}{if(!r)return null;let e=(0,$.o)(new Date),t=(0,$.o)(r);if(t<e)return{status:"recurring",message:"Recurring countdown active",subMessage:"Next occurrence will be calculated",days:0};{let a=(0,ee.c)(t,e);return{status:"recurring",message:"".concat(a," days until next occurrence"),subMessage:"Repeats ".concat(n),days:a}}}},[e,r,d,n]),(0,a.jsx)("div",{className:eL().container,children:(0,a.jsxs)("div",{className:eL().cardContainer,children:[(0,a.jsxs)("div",{className:eL().tabsContainer,children:[(0,a.jsx)("div",{className:(0,o.cn)(eL().browserTab,"recurring"===e&&eL().activeTab),onClick:()=>k("recurring"),children:(0,a.jsx)("span",{children:"Single"})}),(0,a.jsx)("div",{className:(0,o.cn)(eL().browserTab,"start-end"===e&&eL().activeTab),onClick:()=>k("start-end"),children:(0,a.jsx)("span",{children:"Range"})})]}),(0,a.jsxs)("div",{className:eL().tabContent,children:[(0,a.jsxs)("div",{className:eL().field,children:[(0,a.jsx)("p",{className:eL().fieldLabel,children:"COUNTING DOWN TO:"}),(0,a.jsx)(l.p,{value:h,onChange:e=>_(e.target.value),placeholder:"example: My birthday",className:eL().titleInput})]}),(0,a.jsx)("div",{style:{display:"recurring"===e?"block":"none"},children:(0,a.jsxs)("div",{className:eL().dateFields,children:[(0,a.jsxs)("div",{className:eL().dateField,children:[(0,a.jsx)("p",{className:eL().fieldLabel,children:"DATE RANGE"}),(0,a.jsx)(eM,{date:r,onSelect:c,placeholder:"22/07/25",className:eL().dateButton})]}),(0,a.jsxs)("div",{className:eL().dateField,children:[(0,a.jsx)("p",{className:eL().fieldLabel,children:"RECUR"}),(0,a.jsxs)(ek,{value:n,onValueChange:T,children:[(0,a.jsx)(eE,{className:eL().selectTrigger,children:(0,a.jsx)(eD,{})}),(0,a.jsxs)(eI,{children:[(0,a.jsx)(eA,{value:"none",children:"None"}),(0,a.jsx)(eA,{value:"weekly",children:"Weekly"}),(0,a.jsx)(eA,{value:"fortnightly",children:"Fortnightly"}),(0,a.jsx)(eA,{value:"monthly",children:"Monthly"}),(0,a.jsx)(eA,{value:"annual",children:"Annual"})]})]})]})]})}),(0,a.jsx)("div",{style:{display:"start-end"===e?"block":"none"},children:(0,a.jsxs)("div",{className:eL().dateFields,children:[(0,a.jsxs)("div",{className:eL().dateField,children:[(0,a.jsx)("p",{className:eL().fieldLabel,children:"START"}),(0,a.jsx)(eM,{date:r,onSelect:c,placeholder:"22/07/25",className:eL().dateButton})]}),(0,a.jsxs)("div",{className:eL().dateField,children:[(0,a.jsx)("p",{className:eL().fieldLabel,children:"END"}),(0,a.jsx)(eM,{date:d,onSelect:u,placeholder:"23/07/25",className:eL().dateButton})]})]})}),f&&"start-end"===e&&(!r||!d)&&(0,a.jsx)("div",{className:eL().error,children:"Please select both start and end dates"}),f&&"recurring"===e&&!r&&(0,a.jsx)("div",{className:eL().error,children:"Please select a starting date"}),(0,a.jsx)(e_.$,{onClick:C,disabled:p,className:eL().saveButton,children:p?"Saving...":"Save"}),w&&(0,a.jsx)("div",{className:eL().success,children:"Countdown settings saved successfully!"})]})]})})}},{name:"Weather",description:"Set location(s) and localisation",component:()=>(0,a.jsx)("div",{children:"Weather Settings"})},{name:"Account",description:"Accounts, Calendar and Authentication",component:function(){var e,t,i;let{user:r,loading:o}=(0,D.A)(),l=(0,ep.jE)();(0,s.useEffect)(()=>{console.log("AccountSettings mounted:",{user:null==r?void 0:r.email,id:null==r?void 0:r.id,loading:o,metadata:null==r?void 0:r.user_metadata})},[r,o]);let{data:c,isLoading:d}=(0,z.I)({queryKey:["googleCalendarConnected"],queryFn:async()=>{let e=await fetch("/api/calendar/status",{credentials:"include"});return!!e.ok&&(await e.json()).connected},enabled:!!(null==r?void 0:r.id)}),{data:u=[],isLoading:g}=(0,z.I)({queryKey:["connectedAccounts"],queryFn:async()=>{let e=await fetch("/api/settings/accounts",{credentials:"include"});if(!e.ok)return console.error("Failed to fetch connected accounts:",e.status),[];let t=await e.json();return console.log("Connected accounts:",t),t.filter(e=>{var t;return e.providerAccountId!==(null==(t=r.user_metadata)?void 0:t.provider_id)})},enabled:!!(null==r?void 0:r.id)}),m=(0,ev.n)({mutationFn:async()=>{let e=await fetch("/api/auth/google-link-url?next=/settings");if(!e.ok)throw Error("Failed to get authorization URL.");let{authUrl:t}=await e.json();window.location.href=t},onError:e=>{console.error("Failed to initiate add account flow:",e)}}),h=(0,ev.n)({mutationFn:async e=>{let t=await fetch("/api/settings/accounts?id=".concat(e),{method:"DELETE",credentials:"include"});if(!t.ok)throw Error("Failed to remove account");return t.json()},onSuccess:()=>{l.invalidateQueries({queryKey:["connectedAccounts"]})}}),_=(0,ev.n)({mutationFn:async()=>{let e=await fetch("/api/settings/disconnect-calendar",{method:"POST",credentials:"include"});if(!e.ok)throw Error("Failed to disconnect calendar");return e.json()},onSuccess:()=>{l.invalidateQueries({queryKey:["googleCalendarConnected"]})}});async function p(){try{let e=await fetch("/api/auth/connect-calendar",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include"});if((await e.json()).success)l.invalidateQueries({queryKey:["googleCalendarConnected"]});else{let{createClient:e}=await Promise.resolve().then(n.bind(n,8525)),t=e();await t.auth.signInWithOAuth({provider:"google",options:{redirectTo:"".concat(window.location.origin,"/auth/callback"),scopes:"openid email profile https://www.googleapis.com/auth/calendar.readonly https://www.googleapis.com/auth/calendar.events.readonly",queryParams:{access_type:"offline",prompt:"consent"}}})}}catch(e){console.error("Error connecting calendar:",e)}}return o?(0,a.jsx)("div",{className:ef().spaceY4,children:(0,a.jsx)("div",{className:ef().card,children:(0,a.jsx)("div",{className:ef().textWhite60,children:"Loading account information..."})})}):r?(0,a.jsxs)("div",{className:ef().spaceY4,children:[(0,a.jsxs)("div",{className:ef().card,children:[(0,a.jsx)("div",{className:ef().flexJustifyBetweenMb3,children:(0,a.jsx)("h3",{className:ef().primaryAccountTitle,children:"Primary Account"})}),(0,a.jsxs)("div",{className:ef().flexJustifyBetween,children:[(0,a.jsxs)("div",{className:ef().flexItemsGap3,children:[(0,a.jsx)("div",{className:ef().avatar,children:(null==(e=r.user_metadata)?void 0:e.avatar_url)?(0,a.jsx)(ew.default,{src:r.user_metadata.avatar_url,alt:"",fill:!0,className:ef().avatarImage}):(0,a.jsx)("span",{className:ef().userIcon,children:"\uD83D\uDC64"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:ef().userNameText,children:(null==(t=r.user_metadata)?void 0:t.full_name)||(null==(i=r.email)?void 0:i.split("@")[0])||"User"}),(0,a.jsx)("div",{className:ef().userEmailText,children:r.email||"No email"})]})]}),d?(0,a.jsx)("div",{className:ef().loadingPlaceholder}):c?(0,a.jsxs)(e_.$,{variant:"outline",size:"sm",onClick:()=>_.mutate(),disabled:_.isPending,className:ef().disconnectButton,children:[(0,a.jsx)("span",{className:ef().iconXsMr,children:"\xd7"}),"Disconnect"]}):(0,a.jsxs)(e_.$,{variant:"outline",size:"sm",onClick:p,className:ef().disconnectButton,children:[(0,a.jsx)("span",{className:ef().iconXsMr,children:"â—Š"}),"Connect"]})]})]}),(0,a.jsxs)("div",{className:ef().card,children:[(0,a.jsxs)("div",{className:ef().mb3,children:[(0,a.jsx)("h3",{className:ef().additionalAccountsTitle,children:"Additional schedule accounts"}),(0,a.jsx)("p",{className:ef().additionalAccountsDescription,children:"Accounts listed below are view only for visibility in schedule widget"})]}),g?(0,a.jsx)("div",{className:ef().py3,children:(0,a.jsx)("div",{className:ef().loadingLine})}):u.length>0?(0,a.jsx)("div",{className:ef().spaceY2,children:u.map(e=>(0,a.jsxs)("div",{className:ef().accountItem,children:[(0,a.jsxs)("div",{className:ef().accountItemContent,children:[(0,a.jsx)("span",{className:ef().userIconSmall,children:"\uD83D\uDC64"}),(0,a.jsx)("div",{className:ef().accountDetails,children:(0,a.jsx)("div",{className:ef().accountEmail,children:e.email})})]}),(0,a.jsx)(e_.$,{variant:"ghost",size:"sm",onClick:()=>h.mutate(e.id),disabled:h.isPending,className:ef().removeButton,children:(0,a.jsx)("span",{className:ef().iconXs,children:"\xd7"})})]},e.id))}):(0,a.jsxs)("div",{className:ef().noAccountsRow,children:[(0,a.jsx)("p",{className:ef().additionalAccountsDescription,children:"No additional accounts"}),(0,a.jsxs)(e_.$,{variant:"ghost",size:"sm",onClick:()=>m.mutate(),disabled:m.isPending,className:ef().addAccountButton,title:"Note: Adding an account will switch your primary account",children:[(0,a.jsx)("span",{className:ef().iconXsMr1,children:"+"}),"Add"]})]})]}),(0,a.jsx)("div",{className:ef().card,children:(0,a.jsxs)("div",{className:ef().flexJustifyBetween,children:[(0,a.jsxs)("div",{className:ef().signedInContainer,children:["Signed in as ",(0,a.jsx)("span",{className:ef().signedInEmailSpan,children:r.email})]}),(0,a.jsxs)(e_.$,{variant:"ghost",size:"sm",onClick:()=>window.location.href="/logout",className:ef().signOutButton,children:[(0,a.jsx)("span",{className:ef().iconXsMr,children:"â€¢"}),"Sign Out"]})]})})]}):(0,a.jsx)("div",{className:ef().spaceY4,children:(0,a.jsxs)("div",{className:ef().card,children:[(0,a.jsxs)("div",{className:"".concat(ef().flexItemsGap2," ").concat(ef().textYellow400," ").concat(ef().mb3),children:[(0,a.jsx)("span",{className:ef().iconSmall,children:"â€¢"}),(0,a.jsx)("span",{className:ef().textSmMedium,children:"Not signed in"})]}),(0,a.jsx)("p",{className:"".concat(ef().textXsWhite60," ").concat(ef().mb3),children:"You need to sign in to manage your account settings."}),(0,a.jsx)(e_.$,{onClick:()=>window.location.href="/login",size:"sm",children:"Sign In"})]})})}}];function eW(e){var t;let{initialTab:n="Display options"}=e,[i,r]=s.useState(!1),[l,c]=s.useState(n);s.useEffect(()=>{i&&n&&c(n)},[i,n]),s.useEffect(()=>{let e=e=>{console.log("SettingsDrawer: Received openSettings event",e.detail);let{tab:t}=e.detail;t&&(console.log('SettingsDrawer: Setting active tab to "'.concat(t,'"')),c(t)),r(!0)};return window.addEventListener("openSettings",e),()=>window.removeEventListener("openSettings",e)},[]);let d=(null==(t=eH.find(e=>e.name===l))?void 0:t.component)||(()=>(0,a.jsx)("div",{children:"Select a setting"}));return(0,a.jsxs)(eh._s,{open:i,onOpenChange:r,children:[(0,a.jsx)(eh.Uz,{asChild:!0,children:(0,a.jsxs)(e_.$,{variant:"ghost",size:"icon",className:(0,o.cn)(eF().drawerTrigger,"group"),"data-testid":"settings-drawer-trigger",children:[(0,a.jsx)("span",{className:eF().settingsIcon,children:"*"}),(0,a.jsx)("span",{className:"sr-only",children:"Open Settings"})]})}),(0,a.jsxs)(eh.zj,{overlayVariant:"settings",className:eF().drawerContent,style:{background:"linear-gradient(rgba(38, 38, 38, 0.5) 0%, rgba(0, 0, 0, .7 ) 100%)",backdropFilter:"blur(12px)"},children:[(0,a.jsx)(eR,{children:(0,a.jsx)(eh.gk,{children:"Settings"})}),(0,a.jsxs)("div",{className:eF().container,children:[(0,a.jsx)("div",{className:eF().grabHandle,children:(0,a.jsx)("div",{className:eF().grabBar})}),(0,a.jsxs)("div",{className:eF().header,children:[(0,a.jsx)("h1",{className:eF().title,children:"Settings"}),(0,a.jsxs)(e_.$,{variant:"ghost",size:"icon",onClick:()=>r(!1),className:eF().closeButton,children:[(0,a.jsx)("span",{className:eF().closeIcon,children:"\xd7"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]}),(0,a.jsxs)("div",{className:eF().scrollableContent,children:[(0,a.jsx)("div",{className:eF().sidebar,children:(0,a.jsx)("nav",{className:eF().nav,children:(0,a.jsx)("ul",{className:eF().navList,children:eH.map(e=>(0,a.jsx)("li",{children:(0,a.jsx)("button",{onClick:()=>c(e.name),className:(0,o.cn)(eF().navButton,l===e.name?eF().navButtonActive:eF().navButtonInactive),children:(0,a.jsxs)("div",{className:eF().navButtonContent,children:[(0,a.jsx)("span",{className:eF().navButtonTitle,children:e.name}),(0,a.jsx)("span",{className:eF().navButtonDescription,children:e.description})]})})},e.name))})})}),(0,a.jsx)("div",{className:eF().mainContent,children:(0,a.jsx)("div",{className:eF().contentPanel,children:(0,a.jsx)(d,{})})})]})]})]})]})}function eU(e,t,n,a){let s=(a-90)*Math.PI/180;return{x:e+n*Math.cos(s),y:t+n*Math.sin(s)}}function eG(e){let{size:t,innerRadius:n,outerRadius:s,startAngle:i,endAngle:r,isHovered:l}=e,c=function(e,t,n,a,s,i){let r=eU(e,t,a,i),o=eU(e,t,a,s),l=eU(e,t,n,i),c=eU(e,t,n,s),d=i-s<=180?"0":"1";return["M",r.x,r.y,"A",a,a,0,d,0,o.x,o.y,"L",c.x,c.y,"A",n,n,0,d,1,l.x,l.y,"Z"].join(" ")}(t/2,t/2,n,s,i,r);return(0,a.jsx)("path",{d:c,className:(0,o.cn)("transition-all duration-200",l?"fill-emerald-500/30 stroke-emerald-500":"fill-muted/20 stroke-muted"),strokeWidth:"2"})}function eV(e){let{isDragging:t,hoveredSlice:n,position:s,originPosition:i}=e;if(!t||!s)return null;let r={top:{startAngle:225,endAngle:315},right:{startAngle:-45,endAngle:45},bottom:{startAngle:45,endAngle:135},left:{startAngle:135,endAngle:225}},o=Object.keys(r).filter(e=>e!==i);return(0,a.jsx)("div",{className:"pointer-events-none fixed top-0 left-0 z-40",style:{transform:"translate(".concat(s.x-100,"px, ").concat(s.y-100,"px)")},children:(0,a.jsx)("svg",{width:200,height:200,viewBox:"0 0 ".concat(200," ").concat(200),children:(0,a.jsx)("g",{transform:"rotate(90 ".concat(100," ").concat(100,")"),children:o.map(e=>{let t=r[e];return(0,a.jsx)(eG,{size:200,innerRadius:60,outerRadius:90,startAngle:t.startAngle,endAngle:t.endAngle,isHovered:n===e},e)})})})})}var eJ=n(10872),eY=n.n(eJ);function eZ(){return(0,a.jsx)("div",{className:eY().loadingContainer,children:(0,a.jsx)("div",{className:eY().loadingImageContainer,children:(0,a.jsx)(ew.default,{src:"/assets/loading.gif",alt:"Loader...",fill:!0,className:"object-contain",priority:!0,unoptimized:!0})})})}function eX(e){let{notes:t,tasks:n}=e,l=(0,s.useRef)(null),c=(0,i.E)(),[d,u]=(0,s.useState)(!1),[g,h]=(0,s.useState)(""),[_,p]=(0,s.useState)(!1),[v,w]=(0,s.useState)(!1),[x,f]=(0,s.useState)(null),[y,j]=(0,s.useState)(null),[N,b]=(0,s.useState)("bottom"),[S,C]=(0,s.useState)([]),T={id:"bottom",x:window.innerWidth/2,y:window.innerHeight-60,width:0,height:0},[k,E]=(0,s.useState)(T);(0,s.useEffect)(()=>(v?document.body.classList.add("dragging"):document.body.classList.remove("dragging"),()=>{document.body.classList.remove("dragging")}),[v]);let D="left"===N||"right"===N,I=(0,s.useCallback)(()=>{let{innerWidth:e,innerHeight:t}=window;C([{id:"top",x:e/2,y:60,width:0,height:0},{id:"bottom",x:e/2,y:t-60,width:0,height:0},{id:"left",x:68,y:t/2,width:0,height:0},{id:"right",x:e-8-60,y:t/2,width:0,height:0}])},[]),A=S.find(e=>e.id===N);return((0,s.useEffect)(()=>(I(),window.addEventListener("resize",I),()=>window.removeEventListener("resize",I)),[I]),(0,s.useEffect)(()=>{A&&c.start({x:A.x,y:A.y},{type:"spring",stiffness:500,damping:40})},[A,c]),A)?(0,a.jsxs)("div",{ref:l,className:"dashboard-container",children:[(0,a.jsx)(eV,{isDragging:v,hoveredSlice:x,position:y,originPosition:N}),(0,a.jsx)("div",{className:"dashboard-content",children:(0,a.jsx)(s.Suspense,{fallback:(0,a.jsx)(eZ,{}),children:(0,a.jsx)(em,{notes:t,tasks:n,searchQuery:g,dockPosition:N})})}),v&&S.map(e=>e.id===N?null:(0,a.jsx)("div",{className:(0,o.cn)("drop-zone",x===e.id?"drop-zone-active":"drop-zone-inactive"),style:{left:e.x,top:e.y}},e.id)),(0,a.jsx)(r.P.div,{drag:!0,dragConstraints:l,onDragStart:(e,t)=>{w(!0),A&&j({x:A.x+A.width/2,y:A.y+A.height/2})},onDrag:(e,t)=>{let n=null,a=1/0;for(let e of S.filter(e=>e.id!==N)){let t=e.x+e.width/2,s=e.y+e.height/2,i=Math.sqrt(Math.pow(info.point.x-t,2)+Math.pow(info.point.y-s,2));i<a&&(a=i,n=e)}n&&a<600?f(n.id):f(null)},onDragEnd:()=>{w(!1),x?b(x):A&&c.start({x:A.x,y:A.y,width:A.width,height:A.height},{type:"spring",stiffness:500,damping:40}),f(null),j(null)},dragMomentum:!1,className:"dock-container",animate:c,children:(0,a.jsxs)("div",{className:(0,o.cn)("dock-content",D?"dock-content-vertical":"dock-content-horizontal"),children:[(0,a.jsx)(m,{showSearch:d,searchQuery:g,setSearchQuery:h,showSettings:_,setShowSettings:p,setShowSearch:u,isVertical:D}),(0,a.jsx)(eW,{}),(0,a.jsx)("div",{className:"dock-handle",onPointerDown:e=>{e.currentTarget.setPointerCapture(e.pointerId)},children:(0,a.jsx)("span",{className:"dock-handle-icon",children:"â‰¡"})})]})})]}):(0,a.jsx)(eZ,{})}},85284:e=>{e.exports={select:"select_select__fTysm",iconContainer:"select_iconContainer__RxKwZ",icon:"select_icon__AYc0_",option:"select_option__m04S1"}},87022:e=>{e.exports={spaceY4:"account-settings_spaceY4__6PB90",card:"account-settings_card__sc_pu",textWhite60:"account-settings_textWhite60__m6CUW",flexItemsGap2:"account-settings_flexItemsGap2__K9SAN",textYellow400:"account-settings_textYellow400__6p7tb",mb3:"account-settings_mb3__E4f7R",iconSmall:"account-settings_iconSmall__Wai4W",textSmMedium:"account-settings_textSmMedium__s242d",textXsWhite60:"account-settings_textXsWhite60__vYJMM",flexJustifyBetween:"account-settings_flexJustifyBetween__orKlf",flexJustifyBetweenMb3:"account-settings_flexJustifyBetweenMb3__PsXJr",primaryAccountTitle:"account-settings_primaryAccountTitle__lsa79",flexItemsGap3:"account-settings_flexItemsGap3__zzhZc",avatar:"account-settings_avatar__29LyE",avatarImage:"account-settings_avatarImage___GFF_",userIcon:"account-settings_userIcon__LlRD3",userNameText:"account-settings_userNameText__9k8Du",userEmailText:"account-settings_userEmailText__ERalO",loadingPlaceholder:"account-settings_loadingPlaceholder__XchaJ",pulse:"account-settings_pulse__7OA3L",disconnectButton:"account-settings_disconnectButton__9TXi7",connectButton:"account-settings_connectButton__R2bdl",iconXs:"account-settings_iconXs__epDrw",iconXsMr:"account-settings_iconXsMr__5J1jQ",iconXsMr1:"account-settings_iconXsMr1__v4oD_",additionalAccountsTitle:"account-settings_additionalAccountsTitle__vVkVP",additionalAccountsDescription:"account-settings_additionalAccountsDescription___SZtE",py3:"account-settings_py3__uqCH8",loadingLine:"account-settings_loadingLine__p4khB",spaceY2:"account-settings_spaceY2__CHLNU",accountItem:"account-settings_accountItem__t7t7K",accountItemContent:"account-settings_accountItemContent__Rarcp",userIconSmall:"account-settings_userIconSmall__4qxWK",accountDetails:"account-settings_accountDetails__tJea7",accountEmail:"account-settings_accountEmail__Wiw11",removeButton:"account-settings_removeButton__uZvFQ",noAccountsRow:"account-settings_noAccountsRow__K5a_d",noAccountsText:"account-settings_noAccountsText__Y_JLk",addAccountButton:"account-settings_addAccountButton__hsO2X",signedInText:"account-settings_signedInText__HxVsi",signedInEmail:"account-settings_signedInEmail__JHv_x",signOutButton:"account-settings_signOutButton__PJQSL",signedInEmailSpan:"account-settings_signedInEmailSpan__0cwmR",signedInContainer:"account-settings_signedInContainer__dvFJL"}}}]);